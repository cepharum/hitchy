<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hitchy Plugins | Hitchy Manual</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/core/assets/css/0.styles.9c038e3a.css" as="style"><link rel="preload" href="/core/assets/js/app.f44c65b6.js" as="script"><link rel="preload" href="/core/assets/js/2.e41aa8d4.js" as="script"><link rel="preload" href="/core/assets/js/8.26f90809.js" as="script"><link rel="preload" href="/core/assets/js/4.22891a47.js" as="script"><link rel="prefetch" href="/core/assets/js/10.942f0f66.js"><link rel="prefetch" href="/core/assets/js/11.c297f81c.js"><link rel="prefetch" href="/core/assets/js/12.60407157.js"><link rel="prefetch" href="/core/assets/js/13.fefb4c83.js"><link rel="prefetch" href="/core/assets/js/14.84194869.js"><link rel="prefetch" href="/core/assets/js/15.51843219.js"><link rel="prefetch" href="/core/assets/js/16.d7a28e25.js"><link rel="prefetch" href="/core/assets/js/17.e243f7b7.js"><link rel="prefetch" href="/core/assets/js/18.b4dd4c68.js"><link rel="prefetch" href="/core/assets/js/3.8ae28129.js"><link rel="prefetch" href="/core/assets/js/5.09b6a9a4.js"><link rel="prefetch" href="/core/assets/js/6.2679362c.js"><link rel="prefetch" href="/core/assets/js/7.75efe953.js"><link rel="prefetch" href="/core/assets/js/9.662b661f.js">
    <link rel="stylesheet" href="/core/assets/css/0.styles.9c038e3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/core/" class="home-link router-link-active"><!----> <span class="site-name">Hitchy Manual</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/core/" class="nav-link">Home</a></div><div class="nav-item"><a href="/core/tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/api/index.html" class="nav-link">Hitchy's API</a></li><li class="dropdown-item"><!----> <a href="/core/api/plugins.html" class="nav-link router-link-exact-active router-link-active">Plugin API</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Internals</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/internals/architecture-basics.html" class="nav-link">Architecture</a></li><li class="dropdown-item"><!----> <a href="/core/internals/components.html" class="nav-link">Components</a></li><li class="dropdown-item"><!----> <a href="/core/internals/bootstrap.html" class="nav-link">Plugins</a></li><li class="dropdown-item"><!----> <a href="/core/internals/routing-basics.html" class="nav-link">Routing</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/plugin-odem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Odem
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/hitchyjs/core" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/core/" class="nav-link">Home</a></div><div class="nav-item"><a href="/core/tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/api/index.html" class="nav-link">Hitchy's API</a></li><li class="dropdown-item"><!----> <a href="/core/api/plugins.html" class="nav-link router-link-exact-active router-link-active">Plugin API</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Internals</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/internals/architecture-basics.html" class="nav-link">Architecture</a></li><li class="dropdown-item"><!----> <a href="/core/internals/components.html" class="nav-link">Components</a></li><li class="dropdown-item"><!----> <a href="/core/internals/bootstrap.html" class="nav-link">Plugins</a></li><li class="dropdown-item"><!----> <a href="/core/internals/routing-basics.html" class="nav-link">Routing</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/plugin-odem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Odem
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/hitchyjs/core" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Hitchy Plugins</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/core/api/plugins.html#naming" class="sidebar-link">Naming</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/core/api/plugins.html#roles" class="sidebar-link">Roles</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/plugins.html#why-using-roles" class="sidebar-link">Why Using Roles?</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#static-vs-dynamic-vs-approved" class="sidebar-link">Static vs. Dynamic vs. Approved</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#uniquity" class="sidebar-link">Uniquity</a></li></ul></li><li><a href="/core/api/plugins.html#basic-file-layout" class="sidebar-link">Basic File Layout</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/plugins.html#minimally-required-files" class="sidebar-link">Minimally Required Files</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#components" class="sidebar-link">Components</a></li></ul></li><li><a href="/core/api/plugins.html#the-beacon-file" class="sidebar-link">The Beacon File</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/plugins.html#role" class="sidebar-link">role</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#dependencies" class="sidebar-link">dependencies</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#dependants" class="sidebar-link">dependants</a></li></ul></li><li><a href="/core/api/plugins.html#common-plugin-api" class="sidebar-link">Common Plugin API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-name" class="sidebar-link">plugin.$name</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-role" class="sidebar-link">plugin.$role</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-meta" class="sidebar-link">plugin.$meta</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-index" class="sidebar-link">plugin.$index</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-config-0-3-3" class="sidebar-link">plugin.$config</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-ondiscovered" class="sidebar-link">plugin.onDiscovered()</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-configure" class="sidebar-link">plugin.configure()</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-onexposing" class="sidebar-link">plugin.onExposing()</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-onexposed" class="sidebar-link">plugin.onExposed()</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-initialize" class="sidebar-link">plugin.initialize()</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-policies" class="sidebar-link">plugin.policies</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-routes" class="sidebar-link">plugin.routes</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-blueprints" class="sidebar-link">plugin.blueprints</a></li><li class="sidebar-sub-header"><a href="/core/api/plugins.html#plugin-shutdown" class="sidebar-link">plugin.shutdown()</a></li></ul></li><li><a href="/core/api/plugins.html#a-plugin-s-particular-api" class="sidebar-link">A Plugin's Particular API</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hitchy-plugins"><a href="#hitchy-plugins" aria-hidden="true" class="header-anchor">#</a> Hitchy Plugins</h1> <p>In this topic you learn how to write plugins for Hitchy. It is also introducing common API of either plugin as assumed by Hitchy to be integrated properly.</p> <h2 id="naming"><a href="#naming" aria-hidden="true" class="header-anchor">#</a> Naming</h2> <p>A plugin's name is equivalent to the base name of folder containing it. Thus, every plugin must be available in a separate folder.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>A plugin locally available in folder <strong>/app/node_modules/hitchy-plugin-foo</strong> is named <strong>hitchy-plugin-foo</strong>.</p></div> <div class="warning custom-block"><p class="custom-block-title">Convention</p> <p>When publishing plugins for Hitchy as packages on npm or similar their name should start with <strong>hitchy-plugin-</strong> by convention. See the <a href="/core/plugins.html">moderated list of existing plugins</a> for examples.</p></div> <h2 id="roles"><a href="#roles" aria-hidden="true" class="header-anchor">#</a> Roles</h2> <p>In addition to its name every plugin is assumed <em>to claim a role</em> it is taking as part of an application. This role's name is identical to the plugin's name by default. But every plugin is able to choose a different role explicitly.</p> <h3 id="why-using-roles"><a href="#why-using-roles" aria-hidden="true" class="header-anchor">#</a> Why Using Roles?</h3> <p>Roles are beneficial for creating complex applications. By supporting plugin roles it is possible to have different implementations for the same purpose resulting in same API available under same name - the role's name - at runtime.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>The plugin hitchy-plugin-odem is claiming role <strong>odm</strong>. Its API is exposed at runtime as <code>api.plugins.odm</code>.</p> <p>A different plugin may be designed as a drop-in replacement for <strong>hitchy-plugin-odem</strong> by claiming same role <strong>odm</strong> and providing same API with a different implementation e.g. for interacting with a different backend for storing data.</p></div> <h3 id="static-vs-dynamic-vs-approved"><a href="#static-vs-dynamic-vs-approved" aria-hidden="true" class="header-anchor">#</a> Static vs. Dynamic vs. Approved</h3> <p>For every plugin a claimed role may be encountered in these situations:</p> <ol><li><p>In its <strong>hitchy.json</strong> beacon file (see below) a plugin may claim role explicitly or rely on role equivalent to its name by default. This role is called the plugin's <em>static role</em>.</p></li> <li><p>A plugin's API may include property <code>$meta</code> to be merged with information read from its <strong>hitchy.json</strong> file before. This may include a <code>role</code> in turn which is called the plugin's <em>dynamic role</em>.</p></li> <li><p>One of these roles - preferring the dynamic role over the static one - becomes the plugin's <em>approved role</em> which is going to be only considered one while integrating either plugin with the application.</p> <p>The approved role of a plugin will be exposed as property <code>$role</code> of its API.</p></li></ol> <p>This pattern is beneficial in plugins dynamically adopting their behaviour to an application's actual context. For example, a plugin may inspect list of available plugins and decide to replace some particular plugin unless application doesn't depend on that plugin at all.</p> <h3 id="uniquity"><a href="#uniquity" aria-hidden="true" class="header-anchor">#</a> Uniquity</h3> <p>A plugin's <a href="#static-vs-dynamic-vs-approved">approved role</a> must be unique in context of a single application. Thus, in a single application you can't have two plugins claiming same role to be approved.</p> <h2 id="basic-file-layout"><a href="#basic-file-layout" aria-hidden="true" class="header-anchor">#</a> Basic File Layout</h2> <h3 id="minimally-required-files"><a href="#minimally-required-files" aria-hidden="true" class="header-anchor">#</a> Minimally Required Files</h3> <p>Every plugin must be implemented in its own folder.</p> <p>This is achieved implicitly when distributing plugins as packages via npm. The folder's name is implicitly assumed to be the plugin's name.</p> <p>Every plugin's folder must contain at least two files:</p> <ul><li><p><strong>hitchy.json</strong> is called the plugin's <a href="#the-beacon-file"><em>beacon file</em></a> for indicating that a folder is actually containing a Hitchy-compatible plugin. That's why <strong>this file must exist</strong>.</p></li> <li><p><strong>index.js</strong> must be provided for exporting the plugin's API. That API is used in two situations:</p> <ol><li><p>It is used to integrate the plugin with an application that is based on Hitchy.</p> <p>This is the <a href="#common-plugin-api">part which is described below</a>.</p></li> <li><p>It may expose additional information and methods for use by the application at runtime. Therefore, it will be exposed as part of a collection in <a href="/core/api/#api-plugins">Hitchy's API</a> using the plugin's role name.</p> <p>This <a href="#a-plugin-s-particular-api">part of API</a> is optional and depends on actual plugin.</p></li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">options<span class="token punctuation">,</span> pluginHandles<span class="token punctuation">,</span> myHandle</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO: list elements of plugin's API here</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Complying with <a href="/core/api/#using-common-module-pattern">common module pattern</a> is highly suggested to use the <a href="/core/internals/bootstrap.html#validating-claimed-roles">full potential of integrating with an application</a>. But it's not required and thus it's okay to export the plugin's API without:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO: list elements of plugin's API here</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p>Using <a href="https://docs.npmjs.com/files/package.json#main" target="_blank" rel="noopener noreferrer">package.json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> it is possible to select a different name used for loading plugin's API.</p></div></li></ul> <p>As a result any plugin's folder should look similar to this layout:</p> <div class="language- extra-class"><pre class="language-text"><code>+ hitchy-plugin-foo
    hitchy.json
    index.js
</code></pre></div><h3 id="configuration"><a href="#configuration" aria-hidden="true" class="header-anchor">#</a> Configuration</h3> <p>Every plugin may provide configuration to be merged into resulting application's configuration by providing a sub-folder <strong>config</strong> containing one or more Javascript files each exposing another part of desired configuration.</p> <div class="language- extra-class"><pre class="language-text"><code>+ hitchy-plugin-foo
  + config
      foo.js
      bar.js  
    hitchy.json
    index.js
</code></pre></div><p>Names of configuration files don't matter as long as they don't start with a full stop <code>.</code> and end in <strong>.js</strong>.</p> <p>Either plugin's configuration as merged data of all files loaded here is exposed as <a href="#plugin-config-0-3-3">part of plugin's resulting API</a>. Configuration of all plugins and resulting application is merged and gets eventually exposed via <a href="/core/api/#api-config">Hitchy's API</a>.</p> <h3 id="components"><a href="#components" aria-hidden="true" class="header-anchor">#</a> Components</h3> <p>Just like the application itself every plugin may expose <a href="/core/internals/components.html">components</a> to be discovered and exposed via Hitchy's API. Thus, a plugin may contain a folder <strong>api</strong> which in turn may contain any combination of the sub-folders <strong>controllers</strong>, <strong>policies</strong>, <strong>models</strong> and <strong>services</strong>.</p> <div class="tip custom-block"><p class="custom-block-title">Singular Names</p> <p>Using singular names for those four folders is supported as well.</p></div> <div class="language- extra-class"><pre class="language-text"><code>+ hitchy-plugin-foo
  + api
    + controllers
        foo.js
    + policies
        bar.js
    + services
        foo.js
        bar.js
    + models
        foo.js
  + config
      foo.js
      bar.js  
    hitchy.json
    index.js
</code></pre></div><p>Discovered components are exposed via <a href="/core/api/#api-runtime">Hitchy's API</a>.</p> <h2 id="the-beacon-file"><a href="#the-beacon-file" aria-hidden="true" class="header-anchor">#</a> The Beacon File</h2> <p>Every folder or package meant to be discovered as a Hitchy plugin must contain a file named <strong>hitchy.json</strong>. This file doesn't have to contain any information and thus could be as simple as this:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>The file is used as a <em>beacon</em> indicating its folder to contain a plugin for Hitchy. By relying on its presence discovering plugins is pretty fast resulting in shorter startup times.</p> <p>There may be actual content in the file, though.</p> <ul><li><p>The content is playing an essential part in integrating either plugin as it might describe a plugin's slight deviation from API assumed by Hitchy.</p></li> <li><p>It may give explicit values for defaults assumed otherwise.</p></li> <li><p>Another option is declaring other plugins either plugin depends on. This is resulting in a certain dependency graph which is used to create a properly sorted list of plugins obeyed while integrating them with an application as well as on routing requests through routes exposed by either plugin.</p></li></ul> <p>Last but not least there may be custom information which is <a href="#plugin-meta">exposed as part of either plugin's API</a>.</p> <h3 id="role"><a href="#role" aria-hidden="true" class="header-anchor">#</a> role</h3> <p>This property of <strong>hitchy.json</strong> file is statically claiming a certain <a href="#roles">role</a> by name. It defaults to the plugin's name which in turn is equivalent to the filename of folder containing the <strong>hitchy.json</strong> file.</p> <p>In opposition to that either plugin gets a chance to claim a different role dynamically e.g. after inspecting whole list of actually discovered plugins.</p> <h3 id="dependencies"><a href="#dependencies" aria-hidden="true" class="header-anchor">#</a> dependencies</h3> <p>Either plugin may declare <em>roles</em> of plugins it depends on. This affects bootstrap in several ways:</p> <ul><li><p>When sorting plugins for sequential processing any plugin listing roles as its dependencies here is processed after those plugins claiming either role.</p></li> <li><p>If any of the declared dependencies is missing the bootstrap fails cancelling whole application startup.</p></li></ul> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>The plugin <strong>hitchy-plugin-odem-rest</strong> is declaring to depend on role <strong>odm</strong> which is claimed by plugin <strong>hitchy-plugin-odem</strong>.</p> <p><strong>hitchy-plugin-odem-rest/hitchy.json:</strong></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token string">&quot;odm-provider&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token string">&quot;odm&quot;</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="dependants"><a href="#dependants" aria-hidden="true" class="header-anchor">#</a> dependants</h3> <p>A plugin is capable of listing roles depending on it without requiring plugins claiming those roles to declare related dependency on their own.</p> <p>Using this property is less common but supported for sake of integrity as it is controlling sorting order of plugins in direction opposite to declaring dependencies as described above.</p> <h2 id="common-plugin-api"><a href="#common-plugin-api" aria-hidden="true" class="header-anchor">#</a> Common Plugin API</h2> <p>This is a summary of properties and methods in a plugin's API supported by Hitchy for integrating the plugin with an application. See the <a href="/core/internals/bootstrap.html">description of process integrating plugins</a> for additional information.</p> <div class="tip custom-block"><p>There are no two kinds of APIs for every plugin. But some properties of a plugin's API are detected and handled by Hitchy on integrating the plugin with an application while the rest of that API is ignored by Hitchy.</p></div> <h3 id="plugin-name"><a href="#plugin-name" aria-hidden="true" class="header-anchor">#</a> plugin.$name</h3> <p>This property names the plugin which is exposing this API.</p> <h3 id="plugin-role"><a href="#plugin-role" aria-hidden="true" class="header-anchor">#</a> plugin.$role</h3> <p>This property names the role claimed by plugin exposing this API. Since accessing the plugin involves knowing the role this information may be considered redundant but is included for sake of integrity.</p> <h3 id="plugin-meta"><a href="#plugin-meta" aria-hidden="true" class="header-anchor">#</a> plugin.$meta</h3> <p>When exported by <a href="#basic-file-layout">a plugin's <strong>index.js</strong> file</a> this property is meant to provide information extending and/or replacing related information found in plugin's beacon file.</p> <p>After <a href="/core/internals/bootstrap.html#loading-plugins">loading plugin in discovery stage</a> exported information is merged with any information found in beacon file. Thus, this object is eventually providing final state of a plugin's meta information.</p> <h3 id="plugin-index"><a href="#plugin-index" aria-hidden="true" class="header-anchor">#</a> plugin.$index</h3> <p>Due to sorting plugins for sequential processing either plugin has an index into that list which is exposed in this property mostly for testing purposes.</p> <h3 id="plugin-config-0-3-3"><a href="#plugin-config-0-3-3" aria-hidden="true" class="header-anchor">#</a> plugin.$config <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>0.3.3+</span></h3> <p>When loading configuration files of a plugin a single object merged from information exported by either found file is exposed as part of plugin's API. The information is also merged with related configuration objects of all other plugins and the application itself into one <a href="/core/api/#api-config-0-3-0">global configuration object</a>.</p> <h3 id="plugin-ondiscovered"><a href="#plugin-ondiscovered" aria-hidden="true" class="header-anchor">#</a> plugin.onDiscovered()</h3> <p><strong>Signature:</strong> <code>onDiscovered( options, pluginHandles, myHandle )</code></p> <p>This optional method is invoked on all eventually integrated plugin's APIs have been loaded. At this point every plugin's API has been loaded and is available as part of provided <a href="/core/internals/bootstrap.html#a-plugin-s-handle">handles</a>.</p> <div class="tip custom-block"><p>Plugins may be discovered but fail to be integrated with the application eventually. This is mostly due to <a href="/core/internals/bootstrap.html#validating-claimed-roles">loosing claimed role</a> to another plugin.</p></div> <h3 id="plugin-configure"><a href="#plugin-configure" aria-hidden="true" class="header-anchor">#</a> plugin.configure()</h3> <p><strong>Signature:</strong> <code>configure( options, myHandle )</code></p> <p>This optional method is invoked at end of configuration stage to request either plugin for fixing any <a href="#configuration">configuration read from its files</a>.</p> <div class="tip custom-block"><p>Returning a promise is supported for deferring bootstrap until promise is settled. On rejecting promise or on throwing the bootstrap fails.</p></div> <h3 id="plugin-onexposing"><a href="#plugin-onexposing" aria-hidden="true" class="header-anchor">#</a> plugin.onExposing()</h3> <p><strong>Signature:</strong> <code>onExposing( options, myHandle )</code></p> <p>This optional method is invoked at start of exposure stage right before detecting either plugin's components and exposing them in <a href="/core/api/#api-runtime">Hitchy's API</a>.</p> <div class="tip custom-block"><p>Returning a promise is supported for deferring bootstrap until promise is settled. On rejecting promise or on throwing the bootstrap fails.</p></div> <h3 id="plugin-onexposed"><a href="#plugin-onexposed" aria-hidden="true" class="header-anchor">#</a> plugin.onExposed()</h3> <p><strong>Signature:</strong> <code>onExposed( options, myHandle )</code></p> <p>This optional method is invoked at end of exposure stage after having detecting and <a href="/core/api/#api-runtime">exposed</a> either plugin's components.</p> <div class="tip custom-block"><p>Returning a promise is supported for deferring bootstrap until promise is settled. On rejecting promise or on throwing the bootstrap fails.</p></div> <h3 id="plugin-initialize"><a href="#plugin-initialize" aria-hidden="true" class="header-anchor">#</a> plugin.initialize()</h3> <p><strong>Signature:</strong> <code>initialize( options, myHandle )</code></p> <p>This optional method is invoked so the plugin is able to initialise its resources e.g. by connecting to some database.</p> <div class="tip custom-block"><p>Returning a promise is supported for deferring bootstrap until promise is settled. On rejecting promise or on throwing the bootstrap fails.</p></div> <h3 id="plugin-policies"><a href="#plugin-policies" aria-hidden="true" class="header-anchor">#</a> plugin.policies</h3> <p><strong>Signatures:</strong> <code>policies</code> or <code>policies( options, myHandle )</code></p> <p>This optional property or method is used to fetch a plugin's routing declarations for policies during <a href="/core/internals/bootstrap.html#routing">routing stage of bootstrap</a>. It is either an object with structure equivalent to the one <a href="/core/api/#config-policies">supported in configuration</a> or some method invoked in compliance with <a href="/core/api/#common-module-function-pattern">common module function pattern</a> to get that set of declarations.</p> <div class="tip custom-block"><p>In addition, it is possible to expose this property as a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises" target="_blank" rel="noopener noreferrer">Promise<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which is fulfilled with the actual set of routing declarations.</p></div> <div class="warning custom-block"><p class="custom-block-title">Supporting &quot;Slots&quot;</p> <p>In opposition to an application's custom routing declarations, a plugin is capable of choosing virtual routing slots <code>before</code> and <code>after</code>, only. In opposition to application's support for routing slots those names are used to pick the <a href="/core/internals/routing-basics.html#routing-stages">block of policies either preceding or succeeding the block of routes</a>.</p></div> <h3 id="plugin-routes"><a href="#plugin-routes" aria-hidden="true" class="header-anchor">#</a> plugin.routes</h3> <p><strong>Signatures:</strong> <code>routes</code> or <code>routes( options, myHandle )</code></p> <p>Similar to <a href="#plugin-policies"><code>plugin.policies</code></a> this optional property or method is used to fetch plugin's routing declarations for (terminal) routes during <a href="/core/internals/bootstrap.html#routing">routing stage of bootstrap</a>. See its <a href="/core/api/#config-routes">configuration counterpart</a> for information on supported syntax.</p> <div class="tip custom-block"><p>In addition, it is possible to expose this property as a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises" target="_blank" rel="noopener noreferrer">Promise<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which is fulfilled with the actual set of routing declarations.</p></div> <div class="warning custom-block"><p class="custom-block-title">Supporting &quot;Slots&quot;</p> <p>In opposition to an application's custom routing declarations, a plugin is capable of choosing virtual routing slots <code>before</code> and <code>after</code>, only. In opposition to application's support for routing slots those names are used to pick the <a href="/core/internals/routing-basics.html#focusing-on-routes">block of routes either preceding or succeeding the block of blueprint routes</a>.</p></div> <h3 id="plugin-blueprints"><a href="#plugin-blueprints" aria-hidden="true" class="header-anchor">#</a> plugin.blueprints</h3> <p><strong>Signatures:</strong> <code>routes</code> or <code>routes( options, myHandle )</code></p> <p>Similar to <a href="#plugin-routes"><code>plugin.routes</code></a> this optional property or method is used to fetch plugin's routing declarations for <a href="/core/internals/routing-basics.html#focusing-on-routes">blueprint routes</a> during <a href="/core/internals/bootstrap.html#routing">routing stage of bootstrap</a>. The supported syntax is basically identical to the one supported by <code>plugin.routes</code>, though blueprints are limited in multiple ways:</p> <div class="tip custom-block"><p>In addition, it is possible to expose this property as a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises" target="_blank" rel="noopener noreferrer">Promise<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which is fulfilled with the actual set of routing declarations.</p></div> <div class="warning custom-block"><p class="custom-block-title">Supporting &quot;Slots&quot;</p> <p>When it comes to declaring blueprints there is no support for selecting any kind of <em>routing slot</em>. Thus, declarations of blueprint routes don't support sub-divisions like policies or routes.</p></div> <h3 id="plugin-shutdown"><a href="#plugin-shutdown" aria-hidden="true" class="header-anchor">#</a> plugin.shutdown()</h3> <p><strong>Signature:</strong> <code>shutdown( options, myHandle )</code></p> <p>This optional method is invoked on gracefully shutting down Hitchy-based application. it is meant to enable a plugin to release its resources e.g. by disconnecting from some database.</p> <div class="tip custom-block"><p>Returning a promise is supported for deferring bootstrap until promise is settled.</p></div> <h2 id="a-plugin-s-particular-api"><a href="#a-plugin-s-particular-api" aria-hidden="true" class="header-anchor">#</a> A Plugin's Particular API</h2> <p>In addition to complying with Hitchy's Plugin API every plugin may expose its own API to be made available via <a href="/core/api/#api-plugins">Hitchy's API</a> available at runtime of a Hitchy-based application.</p> <p>A plugin's API is specific to either plugin and thus you should consult the plugin's documentation.</p> <div class="tip custom-block"><p>There are no two kinds of APIs for every plugin. But some properties of a plugin's API are detected and handled by Hitchy on integrating the plugin with an application while the rest of that API is ignored by Hitchy.</p> <p>The API eventually exposed via Hitchy's API is always covering both parts of a plugin's API.</p></div> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>A plugin named <strong>my-plugin</strong> and claiming role <strong>widgets</strong> exposes an API like this:</p> <p><strong>my-plugin/index.js:</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Widget</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">createWidget</span><span class="token punctuation">(</span> <span class="token parameter">name</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    Widget<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The application is capable of using this API using <code>api.plugins.widgets.createWidget( name )</code> or <code>new api.plugins.widgets.Widget()</code>.</p></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/core/assets/js/app.f44c65b6.js" defer></script><script src="/core/assets/js/2.e41aa8d4.js" defer></script><script src="/core/assets/js/8.26f90809.js" defer></script><script src="/core/assets/js/4.22891a47.js" defer></script>
  </body>
</html>
