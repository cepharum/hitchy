<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hitchy&#39;s API | Hitchy Manual</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/core/assets/css/0.styles.9c038e3a.css" as="style"><link rel="preload" href="/core/assets/js/app.adffbd2d.js" as="script"><link rel="preload" href="/core/assets/js/2.e41aa8d4.js" as="script"><link rel="preload" href="/core/assets/js/7.9402f609.js" as="script"><link rel="preload" href="/core/assets/js/4.2ef88de2.js" as="script"><link rel="prefetch" href="/core/assets/js/10.78ffda59.js"><link rel="prefetch" href="/core/assets/js/11.5f91163b.js"><link rel="prefetch" href="/core/assets/js/12.6cb96a12.js"><link rel="prefetch" href="/core/assets/js/13.1ea5345d.js"><link rel="prefetch" href="/core/assets/js/14.0a9cfd54.js"><link rel="prefetch" href="/core/assets/js/15.658913dc.js"><link rel="prefetch" href="/core/assets/js/16.4a11ec5c.js"><link rel="prefetch" href="/core/assets/js/3.a1a45571.js"><link rel="prefetch" href="/core/assets/js/5.09b6a9a4.js"><link rel="prefetch" href="/core/assets/js/6.c3e42733.js"><link rel="prefetch" href="/core/assets/js/8.19626ae1.js"><link rel="prefetch" href="/core/assets/js/9.8d2a5b1c.js">
    <link rel="stylesheet" href="/core/assets/css/0.styles.9c038e3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/core/" class="home-link router-link-active"><!----> <span class="site-name">Hitchy Manual</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/core/" class="nav-link">Home</a></div><div class="nav-item"><a href="/core/tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><a href="/core/api/" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="/core/internals/" class="nav-link">Internals</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/plugin-odem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Odem
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/core/" class="nav-link">Home</a></div><div class="nav-item"><a href="/core/tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><a href="/core/api/" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="/core/internals/" class="nav-link">Internals</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/plugin-odem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Odem
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Hitchy's API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/core/api/#gaining-access" class="sidebar-link">Gaining Access</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#using-common-module-pattern" class="sidebar-link">Using Common Module Pattern</a></li><li class="sidebar-sub-header"><a href="/core/api/#in-request-handlers" class="sidebar-link">In Request Handlers</a></li></ul></li><li><a href="/core/api/#api-elements" class="sidebar-link">API Elements</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/core/api/#request-helpers" class="sidebar-link">Request Helpers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#req-accept" class="sidebar-link">req.accept</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-cookies" class="sidebar-link">req.cookies</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-fetchbody-parser" class="sidebar-link">req.fetchBody( parser )</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-hitchy" class="sidebar-link">req.hitchy</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-params" class="sidebar-link">req.params</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-path" class="sidebar-link">req.path</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-query" class="sidebar-link">req.query</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-session" class="sidebar-link">req.session</a></li></ul></li><li><a href="/core/api/#response-helpers" class="sidebar-link">Response Helpers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#res-format-handlers" class="sidebar-link">res.format( handlers )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-json-data" class="sidebar-link">res.json( data )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-redirect-statuscode-url" class="sidebar-link">res.redirect( statusCode, url )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-send-content" class="sidebar-link">res.send( content )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-set-name-value" class="sidebar-link">res.set( name, value )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-set-fields" class="sidebar-link">res.set( fields )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-status-code" class="sidebar-link">res.status( code )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-type-mime" class="sidebar-link">res.type( mime )</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hitchy-s-api"><a href="#hitchy-s-api" aria-hidden="true" class="header-anchor">#</a> Hitchy's API</h1> <h2 id="gaining-access"><a href="#gaining-access" aria-hidden="true" class="header-anchor">#</a> Gaining Access</h2> <p>In a fully running application Hitchy's API is available</p> <ul><li>in every plugin complying with one of two patterns named <em>common module pattern</em> and <em>common module function pattern</em>,</li> <li>in any function invoked on routing a request, that is
<ul><li>inline functions used in routing configurations,</li> <li>methods of a controller and</li> <li>methods of a policy.</li></ul></li></ul> <h3 id="using-common-module-pattern"><a href="#using-common-module-pattern" aria-hidden="true" class="header-anchor">#</a> Using Common Module Pattern</h3> <p>Plugins and components discovered by Hitchy are just software modules that may export an API as usual:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// add some code here</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">customFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// add some code here</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>This example shows a software module that's exposing two functions to be its API the usual way.</p> <p>Hitchy's core supports so called <em>common module pattern</em> when <em>discovering</em> plugins and their components.</p> <div class="warning custom-block"><p class="custom-block-title">Discovering Modules?</p> <p>In Hitchy <em>discovering</em> a module is different from <em>requiring</em> it. The term discovery refers to Hitchy's capability of <a href="/core/internals/architecture-basics.html#discovering-plugins">automatically loading a module during bootstrap</a>. In opposition to that any code of your application may still <code>require()</code> modules though <strong>this is going to have some negative side effects for modules relying on <em>common module pattern</em></strong>.</p></div> <p>The common module pattern is a convention allowing any complying module to export a function instead of its API. This function is invoked by Hitchy's bootstrap code to retrieve the actual API of the module:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">options</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// add some code here</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">customFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// add some code here</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>This is the counterpart of same module as before. But this time it is relying on the common module pattern mostly to gain access on Hitchy's API. During discovery of plugins and components any function exported from either module is invoked with Hitchy's API provided as <code>this</code> and global options describing runtime context and arguments passed on starting Hitchy in first argument.</p> <div class="warning custom-block"><p class="custom-block-title">Related Issues</p> <p>On exporting an ES6 class in a module Hitchy might falsely consider this module to comply with common module pattern.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyServiceComponent</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO add methods here</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyServiceComponent<span class="token punctuation">;</span>
</code></pre></div><p>This results in error on Hitchy start regarding invoking your exposed class without operator <code>new</code>. As a fix you might need to wrap this class in a function to actually comply with common module pattern.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">MyServiceComponent</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO add methods here</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> MyServiceComponent<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Alternatively you might add static property <code>useCMP</code> set <code>false</code> to prevent Hitchy from assuming this module is complying with common module pattern.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyServiceComponent</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO add methods here</span>
    
    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">useCMP</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyServiceComponent<span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="in-request-handlers"><a href="#in-request-handlers" aria-hidden="true" class="header-anchor">#</a> In Request Handlers</h3> <p>In request handlers the API is exposed in two different ways:</p> <ol><li><p>Every request handler is invoked with <code>this</code> referring to some <em>request context</em> which is including reference on Hitchy's API in property <code>api</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">someRequestHandler</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// access Hitchy's API via this.api here ...</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Starting with v0.2.0 the API is exposed as property <code>hitchy</code> of given request descriptor as well. This enables use of arrow functions and helps with accessing the API in nested functions and callbacks more easily:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// access Hitchy's API via req.hitchy here ...</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h2 id="api-elements"><a href="#api-elements" aria-hidden="true" class="header-anchor">#</a> API Elements</h2> <p>tba.</p> <h2 id="request-helpers"><a href="#request-helpers" aria-hidden="true" class="header-anchor">#</a> Request Helpers</h2> <p>In request handlers there are two provided arguments usually named <code>req</code> and <code>res</code>. The former is basically an <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_incomingmessage" target="_blank" rel="noopener noreferrer">IncomingMessage<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and the latter is a <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_serverresponse" target="_blank" rel="noopener noreferrer">ServerResponse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. But either object is extended to provide additional information and functionality.</p> <h3 id="req-accept"><a href="#req-accept" aria-hidden="true" class="header-anchor">#</a> <code>req.accept</code></h3> <p>A properly sorted list of MIME type ranges is provided in this property according to any current request's <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept" target="_blank" rel="noopener noreferrer">Accept<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> header field. There is always a list of MIME ranges and either item is provided without optional parameters.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>When handling request with header <code>Accept: text/*;q=0.5, text/json</code> this property will expose sorted list of given MIME ranges <code>[ &quot;text/json&quot;, &quot;text/*&quot; ]</code>.</p></div> <h3 id="req-cookies"><a href="#req-cookies" aria-hidden="true" class="header-anchor">#</a> <code>req.cookies</code></h3> <div class="warning custom-block"><p class="custom-block-title">Requires Plugin</p> <p>This property requires installation of plugin <a href="https://www.npmjs.com/package/hitchy-plugin-cookies" target="_blank" rel="noopener noreferrer">hitchy-plugin-cookies<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as a dependency of your project.</p></div> <p>This property exposes object containing all cookies transmitted by client in current request.</p> <h3 id="req-fetchbody-parser"><a href="#req-fetchbody-parser" aria-hidden="true" class="header-anchor">#</a> <code>req.fetchBody( parser )</code></h3> <p>This method promises request's body. The optional parameter can be used to control parser used for extracting contained information.</p> <div class="warning custom-block"><p>When integrating with ExpressJS this function has limited capabilities to access the raw body and parsed for custom content.</p></div> <ul><li><p>When omitted or set <code>null</code> any parser function in configuration is used to commonly parse raw body for contained information. When there is no configured parser some fallback is used supporting JSON and form-encoded request bodies.</p></li> <li><p>On providing function here this one is used to parse the raw body instead of any configured or fallback parser.</p></li> <li><p>On providing <code>false</code> the raw body is promised as instance of Buffer. This is bypassing any parser to be invoked thus won't result in caching some parser's output as well.</p> <div class="warning custom-block"><p>This method is caching any previously extracted body data. Thus, re-invoking this method with a different parameter doesn't result in another set of information but fetches the same result as before.</p> <p>Providing <code>false</code> is the only exclusion from this rule.</p></div></li></ul> <h3 id="req-hitchy"><a href="#req-hitchy" aria-hidden="true" class="header-anchor">#</a> <code>req.hitchy</code></h3> <p>This property is exposing <a href="#hitchys-api">Hitchy's API</a>.</p> <h3 id="req-params"><a href="#req-params" aria-hidden="true" class="header-anchor">#</a> <code>req.params</code></h3> <p>This object is populated with named segments of currently dispatched route.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>If your handler is bound to handle a route like <code>GET /api/:model/:item</code> and client was requesting <code>/api/user/123</code> then <code>req.params</code> looks like this:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    model<span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
    item<span class="token operator">:</span> <span class="token string">&quot;123&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="req-path"><a href="#req-path" aria-hidden="true" class="header-anchor">#</a> <code>req.path</code></h3> <p>This property conveniently provides current request's path which is the requested URL without any appended query string or hash.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>On requesting <code>/some/path/name?with=arg</code> this property will provide <code>/some/path/name</code>.</p></div> <h3 id="req-query"><a href="#req-query" aria-hidden="true" class="header-anchor">#</a> <code>req.query</code></h3> <p>This property is an object exposing all query parameters.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>On requesting <code>/some/path/name?with=arg&amp;another=one</code> this property will provide the following object:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    with<span class="token operator">:</span> <span class="token string">&quot;arg&quot;</span><span class="token punctuation">,</span>
    another<span class="token operator">:</span>  <span class="token string">&quot;one&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="req-session"><a href="#req-session" aria-hidden="true" class="header-anchor">#</a> <code>req.session</code></h3> <div class="warning custom-block"><p class="custom-block-title">Requires Plugin</p> <p>This property requires installation of plugin <a href="https://www.npmjs.com/package/hitchy-plugin-session" target="_blank" rel="noopener noreferrer">hitchy-plugin-session<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as a dependency of your project.</p></div> <p>This object consists of two properties meant to provide server-side session shared by different requests transmitted from same client.</p> <ul><li><p>In <code>req.session.user</code> currently authenticated user is stored.</p> <div class="warning custom-block"><p>This feature needs installation of another plugin, e.g. <a href="https://www.npmjs.com/package/hitchy-plugin-auth" target="_blank" rel="noopener noreferrer">hitchy-plugin-auth<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div></li> <li><p><code>req.session.data</code> can be used in your controllers and policies to store arbitrary information regarding currently requesting client.</p> <p>Make sure any stored information can be serialized, thus you shouldn't put instances of some custom class in here, but use native data suitable for converting to/from JSON, only.</p></li></ul> <div class="tip custom-block"><p class="custom-block-title">Supported Scenarios</p> <p>Sessions rely on client passing session cookie in every request following some initial one. Usually this is available with browsers requesting pages and assets on behalf of a user. You should not rely on this session feature when it comes to REST APIs, though.</p></div> <h2 id="response-helpers"><a href="#response-helpers" aria-hidden="true" class="header-anchor">#</a> Response Helpers</h2> <p>In handling requests there is a response manager provided in second argument usually named <code>res</code>. Basically this is an instance of <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_serverresponse" target="_blank" rel="noopener noreferrer">ServerResponse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. But Hitchy is injecting some additional methods for simplifying generation of responses.</p> <div class="tip custom-block"><p class="custom-block-title">Fluent Interface</p> <p>Those additional methods listed below are providing fluent interface for chaining multiple invocations. However, signatures of methods natively supported by response manager aren't adjusted.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span> <span class="token number">400</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token string">&quot;content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/json&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Preventing Response on HEAD Requests <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>v0.2.2+</span></p> <p>Requests using HTTP method HEAD must not provide a response. Disobeying this usually results in exceptions thrown e.g. on trying to send some JSON-formatted response.</p> <p>Hitchy is designed to detect any such request limiting capabilities of response manager's methods related to describing some actual content. That's why you don't need to take care of omitting response content in handlers supported HEAD requests as well.</p></div> <h3 id="res-format-handlers"><a href="#res-format-handlers" aria-hidden="true" class="header-anchor">#</a> <code>res.format( handlers )</code></h3> <p>This method provides different handlers for generating response with each handler bound to one particular type or format of response data. According to current request's <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept" target="_blank" rel="noopener noreferrer">Accept<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> header the best matching handler is picked to eventually create a response.</p> <p>A special handler named <code>default</code> is used if neither provided handler is matching any type of response accepted in current request. If this default handler is missing a <code>406 Not Acceptable</code> is issued implicitly in that case.</p> <p>Handlers' names are either MIME types or some supported filename extensions considered aliases for related MIME type.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>Using this function in a request handler</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
    <span class="token function">html</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token string">&quot;&lt;html&gt;...&lt;/html&gt;&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;text/json&quot;</span><span class="token punctuation">(</span> req<span class="token punctuation">,</span> res <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> some<span class="token punctuation">:</span> <span class="token string">&quot;data&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">(</span> req<span class="token punctuation">,</span> res <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token string">&quot;unsupported type of response&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><p>the response is provided as JSON when requesting with <code>Accept: text/json</code> and as an HTML document when requesting with <code>Accept: text/html</code>.</p></div> <h3 id="res-json-data"><a href="#res-json-data" aria-hidden="true" class="header-anchor">#</a> <code>res.json( data )</code></h3> <p>This method generates a JSON-formatted response and sends it to the client. It is ending current response implicitly.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> some<span class="token punctuation">:</span> <span class="token string">&quot;data&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-redirect-statuscode-url"><a href="#res-redirect-statuscode-url" aria-hidden="true" class="header-anchor">#</a> <code>res.redirect( statusCode, url )</code></h3> <p>Use this helper to instantly generate and send response requesting user to fetch different URL for some desired information.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span> <span class="token number">301</span><span class="token punctuation">,</span> <span class="token string">&quot;https://example.com/&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-send-content"><a href="#res-send-content" aria-hidden="true" class="header-anchor">#</a> <code>res.send( content )</code></h3> <p>This method is sending provided content to the client implicitly ending response to current request. The response's type of content depends on type of value provided as <code>content</code> here:</p> <ul><li><p>Providing an object the response is JSON-formatted.</p></li> <li><p>When providing a string the response is sent as plain text unless having set some different <code>content-type</code> header before.</p></li> <li><p>When providing an instance of Buffer or any other kind of data the response is an octet stream with MIME type <code>application/octet-stream</code>.</p></li></ul> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> some<span class="token punctuation">:</span> <span class="token string">&quot;data&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span> <span class="token string">&quot;...&quot;</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-set-name-value"><a href="#res-set-name-value" aria-hidden="true" class="header-anchor">#</a> <code>res.set( name, value )</code></h3> <p>Adjusts single field of response header. Internally this function is invoking <code>res.setHeader()</code>.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token string">&quot;content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/json;charset=utf8&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token string">&quot;x-api-level&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-set-fields"><a href="#res-set-fields" aria-hidden="true" class="header-anchor">#</a> <code>res.set( fields )</code></h3> <p>Adjusts multiple fields of response header at once. Internally this function is invoking <code>res.setHeader()</code> for every listed header field.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;content-type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;text/json;charset=utf8&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;x-api-level&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;3&quot;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-status-code"><a href="#res-status-code" aria-hidden="true" class="header-anchor">#</a> <code>res.status( code )</code></h3> <p>Adjusts HTTP response status code.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span> <span class="token number">404</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">&quot;no such data&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></div> <h3 id="res-type-mime"><a href="#res-type-mime" aria-hidden="true" class="header-anchor">#</a> <code>res.type( mime )</code></h3> <p>Adjusts <code>content-type</code> header field of response supporting several aliases for simplified selection of response type.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span> <span class="token string">&quot;json&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> <span class="token boolean">true</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span> <span class="token string">&quot;image/png&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> bufferContainingPNG <span class="token punctuation">)</span>
</code></pre></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/core/assets/js/app.adffbd2d.js" defer></script><script src="/core/assets/js/2.e41aa8d4.js" defer></script><script src="/core/assets/js/7.9402f609.js" defer></script><script src="/core/assets/js/4.2ef88de2.js" defer></script>
  </body>
</html>
