<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hitchy&#39;s API | Hitchy Manual</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/core/assets/css/0.styles.9c038e3a.css" as="style"><link rel="preload" href="/core/assets/js/app.f44c65b6.js" as="script"><link rel="preload" href="/core/assets/js/2.e41aa8d4.js" as="script"><link rel="preload" href="/core/assets/js/7.75efe953.js" as="script"><link rel="preload" href="/core/assets/js/4.22891a47.js" as="script"><link rel="prefetch" href="/core/assets/js/10.942f0f66.js"><link rel="prefetch" href="/core/assets/js/11.c297f81c.js"><link rel="prefetch" href="/core/assets/js/12.60407157.js"><link rel="prefetch" href="/core/assets/js/13.fefb4c83.js"><link rel="prefetch" href="/core/assets/js/14.84194869.js"><link rel="prefetch" href="/core/assets/js/15.51843219.js"><link rel="prefetch" href="/core/assets/js/16.d7a28e25.js"><link rel="prefetch" href="/core/assets/js/17.e243f7b7.js"><link rel="prefetch" href="/core/assets/js/18.b4dd4c68.js"><link rel="prefetch" href="/core/assets/js/3.8ae28129.js"><link rel="prefetch" href="/core/assets/js/5.09b6a9a4.js"><link rel="prefetch" href="/core/assets/js/6.2679362c.js"><link rel="prefetch" href="/core/assets/js/8.26f90809.js"><link rel="prefetch" href="/core/assets/js/9.662b661f.js">
    <link rel="stylesheet" href="/core/assets/css/0.styles.9c038e3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/core/" class="home-link router-link-active"><!----> <span class="site-name">Hitchy Manual</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/core/" class="nav-link">Home</a></div><div class="nav-item"><a href="/core/tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/api/index.html" class="nav-link">Hitchy's API</a></li><li class="dropdown-item"><!----> <a href="/core/api/plugins.html" class="nav-link">Plugin API</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Internals</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/internals/architecture-basics.html" class="nav-link">Architecture</a></li><li class="dropdown-item"><!----> <a href="/core/internals/components.html" class="nav-link">Components</a></li><li class="dropdown-item"><!----> <a href="/core/internals/bootstrap.html" class="nav-link">Plugins</a></li><li class="dropdown-item"><!----> <a href="/core/internals/routing-basics.html" class="nav-link">Routing</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/plugin-odem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Odem
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/hitchyjs/core" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/core/" class="nav-link">Home</a></div><div class="nav-item"><a href="/core/tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/api/index.html" class="nav-link">Hitchy's API</a></li><li class="dropdown-item"><!----> <a href="/core/api/plugins.html" class="nav-link">Plugin API</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Internals</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/internals/architecture-basics.html" class="nav-link">Architecture</a></li><li class="dropdown-item"><!----> <a href="/core/internals/components.html" class="nav-link">Components</a></li><li class="dropdown-item"><!----> <a href="/core/internals/bootstrap.html" class="nav-link">Plugins</a></li><li class="dropdown-item"><!----> <a href="/core/internals/routing-basics.html" class="nav-link">Routing</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/plugin-odem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Odem
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/hitchyjs/core" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Hitchy's API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/core/api/#gaining-access" class="sidebar-link">Gaining Access</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#using-common-module-pattern" class="sidebar-link">Using Common Module Pattern</a></li><li class="sidebar-sub-header"><a href="/core/api/#in-request-handlers" class="sidebar-link">In Request Handlers</a></li></ul></li><li><a href="/core/api/#options" class="sidebar-link">Options</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#options-projectfolder" class="sidebar-link">options.projectFolder</a></li><li class="sidebar-sub-header"><a href="/core/api/#options-hitchyfolder" class="sidebar-link">options.hitchyFolder</a></li><li class="sidebar-sub-header"><a href="/core/api/#options-extensionsfolder" class="sidebar-link">options.extensionsFolder</a></li><li class="sidebar-sub-header"><a href="/core/api/#options-debug" class="sidebar-link">options.debug</a></li><li class="sidebar-sub-header"><a href="/core/api/#options-dependencies" class="sidebar-link">options.dependencies</a></li></ul></li><li><a href="/core/api/#configuration" class="sidebar-link">Configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#config-policies" class="sidebar-link">config.policies</a></li><li class="sidebar-sub-header"><a href="/core/api/#config-blueprints" class="sidebar-link">config.blueprints</a></li><li class="sidebar-sub-header"><a href="/core/api/#config-routes" class="sidebar-link">config.routes</a></li><li class="sidebar-sub-header"><a href="/core/api/#config-bodyparser" class="sidebar-link">config.bodyParser</a></li><li class="sidebar-sub-header"><a href="/core/api/#config-hitchy-deepcomponents-0-3-3" class="sidebar-link">config.hitchy.deepComponents</a></li><li class="sidebar-sub-header"><a href="/core/api/#config-hitchy-appendfolders-0-3-3" class="sidebar-link">config.hitchy.appendFolders</a></li></ul></li><li><a href="/core/api/#api-elements" class="sidebar-link">API Elements</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#api-config-0-3-0" class="sidebar-link">api.config</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-runtime" class="sidebar-link">api.runtime</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-data" class="sidebar-link">api.data</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-log" class="sidebar-link">api.log</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-utility-file" class="sidebar-link">api.utility.file</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-utility-promise" class="sidebar-link">api.utility.promise</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-utility-object" class="sidebar-link">api.utility.object</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-utility-case" class="sidebar-link">api.utility.case</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-client" class="sidebar-link">api.Client</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-plugins" class="sidebar-link">api.plugins</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-cmp" class="sidebar-link">api.cmp</a></li><li class="sidebar-sub-header"><a href="/core/api/#api-cmfp" class="sidebar-link">api.cmfp</a></li></ul></li><li><a href="/core/api/#request-context" class="sidebar-link">Request Context</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#this-request" class="sidebar-link">this.request</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-response" class="sidebar-link">this.response</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-local" class="sidebar-link">this.local</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-api" class="sidebar-link">this.api</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-config-0-3-0" class="sidebar-link">this.config</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-runtime" class="sidebar-link">this.runtime</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-controllers-0-3-0" class="sidebar-link">this.controllers</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-policies-0-3-0" class="sidebar-link">this.policies</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-services-0-3-0" class="sidebar-link">this.services</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-models-0-3-0" class="sidebar-link">this.models</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-starttime" class="sidebar-link">this.startTime</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-context-0-3-0" class="sidebar-link">this.context</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-done" class="sidebar-link">this.done</a></li><li class="sidebar-sub-header"><a href="/core/api/#this-consumed" class="sidebar-link">this.consumed</a></li></ul></li><li><a href="/core/api/#request-helpers" class="sidebar-link">Request Helpers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#req-accept" class="sidebar-link">req.accept</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-cookies" class="sidebar-link">req.cookies</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-fetchbody-parser" class="sidebar-link">req.fetchBody( parser )</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-hitchy-0-2-0" class="sidebar-link">req.hitchy</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-params" class="sidebar-link">req.params</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-path" class="sidebar-link">req.path</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-query" class="sidebar-link">req.query</a></li><li class="sidebar-sub-header"><a href="/core/api/#req-session" class="sidebar-link">req.session</a></li></ul></li><li><a href="/core/api/#response-helpers" class="sidebar-link">Response Helpers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/api/#res-format-handlers" class="sidebar-link">res.format( handlers )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-json-data" class="sidebar-link">res.json( data )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-redirect-statuscode-url" class="sidebar-link">res.redirect( statusCode, url )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-send-content" class="sidebar-link">res.send( content )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-set-name-value" class="sidebar-link">res.set( name, value )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-set-fields" class="sidebar-link">res.set( fields )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-status-code" class="sidebar-link">res.status( code )</a></li><li class="sidebar-sub-header"><a href="/core/api/#res-type-mime" class="sidebar-link">res.type( mime )</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hitchy-s-api"><a href="#hitchy-s-api" aria-hidden="true" class="header-anchor">#</a> Hitchy's API</h1> <p>In this topic you learn <a href="#gaining-access">how to access Hitchy's API</a> in components of your application. It provides a detailed introduction of <a href="#api-elements">features exposed in that API</a>.</p> <p>Regarding request handling, there is an introduction of special <a href="#request-context">context for every request handler</a> and additional properties and methods provided as part of <a href="#request-helpers">request</a> and <a href="#response-helpers">response</a> descriptors provided as arguments there.</p> <h2 id="gaining-access"><a href="#gaining-access" aria-hidden="true" class="header-anchor">#</a> Gaining Access</h2> <p>In a fully running application Hitchy's API is available</p> <ul><li>in every plugin complying with one of two patterns named <em>common module pattern</em> and <em>common module function pattern</em>,</li> <li>in any function invoked on routing a request, that is
<ul><li>inline functions used in routing configurations,</li> <li>methods of a controller and</li> <li>methods of a policy.</li></ul></li></ul> <h3 id="using-common-module-pattern"><a href="#using-common-module-pattern" aria-hidden="true" class="header-anchor">#</a> Using Common Module Pattern</h3> <p>Plugins and components discovered by Hitchy are (consisting of) modules that may export an API as usual:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// add some code here</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">customFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// add some code here</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>This example shows a software module that's exposing two functions to be its API the usual way.</p> <p>Hitchy's core supports so called <em>common module pattern</em> when <em>discovering</em> plugins and their components.</p> <div class="warning custom-block"><p class="custom-block-title">Discovering Plugins?</p> <p>In Hitchy <em>discovering</em> a plugin is different from <em>requiring</em> it. The term discovery refers to Hitchy's capability of <a href="/core/internals/architecture-basics.html#discovering-plugins">automatically loading a plugin during bootstrap</a>. In opposition to that any code of your application may still <code>require()</code> modules the usual way though <strong>this is going to have some negative side effects for modules relying on <em>common module pattern</em></strong>.</p></div> <p>The common module pattern is a convention allowing any complying module to export a function instead of its API. This function is invoked by Hitchy's bootstrap code to retrieve the actual API of the module:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">options</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// add some code here</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">customFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// add some code here</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>This is the counterpart of same module as before. But this time it is relying on the common module pattern mostly to gain access on Hitchy's API. During discovery of plugins and components any function exported from either module is invoked with Hitchy's API provided as <code>this</code> and global options describing runtime context and arguments passed on starting Hitchy in first argument.</p> <div class="warning custom-block"><p class="custom-block-title">Related Issues</p> <p>On exporting an ES6 class in a module Hitchy might falsely consider this module to comply with common module pattern.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyServiceComponent</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO add methods here</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyServiceComponent<span class="token punctuation">;</span>
</code></pre></div><p>This results in error on Hitchy start regarding invoking your exposed class without operator <code>new</code>. As a fix you might need to wrap this class in a function to actually comply with common module pattern.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">MyServiceComponent</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO add methods here</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> MyServiceComponent<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Alternatively you might add static property <code>useCMP</code> set <code>false</code> to prevent Hitchy from assuming this module is complying with common module pattern.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyServiceComponent</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO add methods here</span>
    
    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">useCMP</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyServiceComponent<span class="token punctuation">;</span>
</code></pre></div></div> <h4 id="returning-promise"><a href="#returning-promise" aria-hidden="true" class="header-anchor">#</a> Returning Promise</h4> <p>When complying with common module pattern a module may return an instance of Promise rather than some API. In that case Hitchy is waiting for the promise to be resolved with the actually desired API.</p> <p>Thus, when complying with common module pattern either module is capable of deferring bootstrap code of Hitchy and get all the opportunities required to deliver its export.</p> <h4 id="passing-additional-information"><a href="#passing-additional-information" aria-hidden="true" class="header-anchor">#</a> Passing Additional Information</h4> <p>Whenever Hitchy is supporting common module pattern it might intend to pass further information in addition to its API and options. This information will be provided as additional arguments following provided options.</p> <h4 id="common-module-function-pattern"><a href="#common-module-function-pattern" aria-hidden="true" class="header-anchor">#</a> Common Module Function Pattern</h4> <p>A similar pattern is supported e.g. when accessing some <a href="/core/api/plugins.html#plugin-policies">elements of a plugin's API</a> and it is named <em>common module function pattern</em>. Just like common module pattern it is meant to support provision of a function to be invoked for generating some data instead of providing that data immediately. And any such function is invoked with Hitchy's API provided as <code>this</code>, Hitchy's options in first argument and any number of additional data provided in further arguments, too.</p> <p>In opposition to common module pattern this isn't about a whole module to be load but just some property exported there. And for the containing module to be capable of complying with common module pattern using this pattern isn't quite as beneficial and commonly useful except for rare cases.</p> <h3 id="in-request-handlers"><a href="#in-request-handlers" aria-hidden="true" class="header-anchor">#</a> In Request Handlers</h3> <p>In request handlers the API is exposed in two different ways:</p> <ol><li><p>Every request handler is invoked with <code>this</code> referring to some <a href="#request-context"><em>request context</em></a> which is including <a href="#this-api">reference on Hitchy's API in property <code>api</code></a>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">someRequestHandler</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// access Hitchy's API via this.api here ...</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Starting with v0.2.0 the API is exposed as property <code>hitchy</code> of given request descriptor as well. This enables use of arrow functions and helps with accessing the API in nested functions and callbacks more easily:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// access Hitchy's API via req.hitchy here ...</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h2 id="options"><a href="#options" aria-hidden="true" class="header-anchor">#</a> Options</h2> <p>When talking about common module pattern before there was an argument passed providing so called <em>Hitchy options</em>.</p> <p>Basically this is a set of parameters provided on invoking Hitchy. Usually this is done via Hitchy's CLI script. Thus, provided options are related to parameters provided on running CLI script. However, when testing Hitchy and its plugins it is possible to pass options from testing scripts as well.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>hitchy /app --extensionFolder /some/different/path --debug
</code></pre></div><p>There are options recognized by Hitchy and some of those get qualified during <a href="/core/internals/architecture-basics.html#discovering-plugins">bootstrap</a>.</p> <p>Additionally provided parameters are included with options available in common module pattern. That's why your application is implicitly capable of supporting custom CLI options for controlling its behaviour.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>hitchy /app --useAuthProvider https://some.auth.provider.com
</code></pre></div><p>These are options recognized and/or managed by Hitchy:</p> <h3 id="options-projectfolder"><a href="#options-projectfolder" aria-hidden="true" class="header-anchor">#</a> options.projectFolder</h3> <p>This option is qualified during triangulation stage of bootstrap. It is addressing folder containing currently running application.</p> <h3 id="options-hitchyfolder"><a href="#options-hitchyfolder" aria-hidden="true" class="header-anchor">#</a> options.hitchyFolder</h3> <p>This option is defined by Hitchy during triangulation stage of bootstrap. It is addressing folder containing Hitchy installation used to manage currently running application.</p> <h3 id="options-extensionsfolder"><a href="#options-extensionsfolder" aria-hidden="true" class="header-anchor">#</a> options.extensionsFolder</h3> <p>This option is optionally addressing different folder assumed to contain all plugins to be discovered. The project folder is used in case of omitting this option.</p> <h3 id="options-debug"><a href="#options-debug" aria-hidden="true" class="header-anchor">#</a> options.debug</h3> <p>This boolean option is controlling whether debug output is desired or not. Basically this option affects Hitchy to always enable any <a href="#api-log">logging facility</a>.</p> <h3 id="options-dependencies"><a href="#options-dependencies" aria-hidden="true" class="header-anchor">#</a> options.dependencies</h3> <p>This option is supported to select plugins current application depends on. It is replacing any such list of plugins read from application's own <strong>hitchy.json</strong> file. In addition it is limiting set of eventually available plugins.</p> <h2 id="configuration"><a href="#configuration" aria-hidden="true" class="header-anchor">#</a> Configuration</h2> <p>During <a href="/core/internals/architecture-basics.html#discovering-plugins">bootstrap</a> Hitchy is <em>shallowly</em> reading Javascript files available in sub-folder <strong>config</strong> of your application as well as of any plugin. Either file is assumed to export part of resulting configuration:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>part <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Either file may comply with <a href="#using-common-module-pattern">common module pattern</a> e.g. to gain access on <a href="#options">Hitchy's options</a> and <a href="#api-elements">its API</a> or to provide its configuration asynchronously by returning Promise.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">options</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">checkSomeSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">info</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                part<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>All files' exports are merged into one configuration object which is exposed at runtime as <a href="#api-config-0-3-0"><code>api.config</code></a> in modules complying with <a href="#using-common-module-pattern">common module pattern</a> and as <a href="#this-config-0-3-0"><code>this.config</code></a> in request handlers.</p> <div class="tip custom-block"><p class="custom-block-title">Rules For Naming Files</p> <p>A configuration file's name</p> <ul><li><strong>must not</strong> start with a full stop <code>.</code> and</li> <li><strong>must</strong> have extension <strong>.js</strong>.</li></ul> <p>Apart from that you may choose any name you like.</p> <p>As a convention, though, there is another file for every first-level property of resulting configuration object with the filename matching that property's name. So, configuration for <code>config.routes</code> would be found in file <strong>config/routes.js</strong> and it is exporting related part of configuration like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>routes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Order of Processing</p> <p>For every plugin as well as the application itself all its configuration files are sorted by name and processed in resulting order. Application's files are processed after either plugin's configuration.</p> <p>In either context a file named <strong>config/local.js</strong> is always processed last. It is meant to contain local-only customizations for all other files which are part of distributed application.</p></div> <p>The structure of configuration depends on used plugins and it might include arbitrary information specific to your application, as well. However, some properties are supported by Hitchy's core and they are listed below:</p> <h3 id="config-policies"><a href="#config-policies" aria-hidden="true" class="header-anchor">#</a> config.policies</h3> <div class="tip custom-block"><p class="custom-block-title">Hitchy's Routing Concept</p> <p>Reading the <a href="/core/internals/routing-basics.html">introduction on Hitchy's routing</a> is highly recommended.</p></div> <p>This property is exposing routing declarations of <a href="/core/internals/routing-basics.html#policies">policies</a>. Policies can be declared in plugins as well as in application.</p> <p>The supported format is mostly identical to the one supported for <code>config.routes</code> below.</p> <div class="tip custom-block"><p>See <a href="#config-routes"><code>config.routes</code></a> for additional information.</p></div> <p>These are the differences between policies and routes:</p> <ul><li><p>When declaring policies targets are addressing <a href="/core/internals/components.html#policies">policy components</a> instead of <a href="/core/internals/components.html#controllers">controller components</a>.</p></li> <li><p>Targets of a route may be declared with optional suffix <strong>Controller</strong>. When declaring policy targets the supported suffix is <strong>Policy</strong> instead.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>config<span class="token punctuation">.</span>routes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;FooController.action&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
config<span class="token punctuation">.</span>policies <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;FooPolicy.action&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>When declaring routes every source must be linked with exactly one target. When declaring policies every source may also have a list of targets to be processed in order.</p> <p><strong>bad:</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>config<span class="token punctuation">.</span>routes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;FooController.action&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;FooController.altAction&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>good:</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>config<span class="token punctuation">.</span>routes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;FooController.action&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
config<span class="token punctuation">.</span>policies <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;FooPolicy.action&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;FooPolicy.altAction&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="config-blueprints"><a href="#config-blueprints" aria-hidden="true" class="header-anchor">#</a> config.blueprints</h3> <div class="warning custom-block"><p>By intention, blueprints are supported in plugins, only.</p></div> <div class="tip custom-block"><p class="custom-block-title">Hitchy's Routing Concept</p> <p>Reading the <a href="/core/internals/routing-basics.html">introduction on Hitchy's routing</a> is highly recommended.</p></div> <p>Declaration of blueprints is mostly equivalent to declaring routes in <a href="#config-routes"><code>config.routes</code></a>. In opposition to that blueprint declarations don't support separate lists per <em>routing slot</em> for there is only one slot for every plugin to declare its blueprint routes.</p> <h3 id="config-routes"><a href="#config-routes" aria-hidden="true" class="header-anchor">#</a> config.routes</h3> <div class="tip custom-block"><p class="custom-block-title">Hitchy's Routing Concept</p> <p>Reading the <a href="/core/internals/routing-basics.html">introduction on Hitchy's routing</a> is highly recommended.</p></div> <p>This property is exposing declarations of (terminal) <a href="/core/internals/routing-basics.html#routes">routes</a>.</p> <div class="warning custom-block"><p class="custom-block-title">Required</p> <p>Routes are essential in Hitchy for it doesn't know how to handle incoming requests otherwise.</p></div> <p>A set of routing declarations is given as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" target="_blank" rel="noopener noreferrer">Object<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or as a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="noopener noreferrer">Map<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> with the latter assuring certain order of processing, though this isn't quite as important in most cases due to Hitchy's routing preferring to match longer sources over shorter ones.</p> <p>The set may be divided into slots for providing different sets per <a href="/core/internals/routing-basics.html#routing-slots">routing slot</a>. Supported names for dividing declarations are <strong>early</strong>, <strong>before</strong>, <strong>after</strong> and <strong>late</strong>. By default, routing declarations are applied to <strong>before</strong> slot.</p> <div class="warning custom-block"><p>Providing declarations per routing slot is not supported for plugins.</p></div> <p>Every single declaration is associating a <em>routing source</em> with a <em>routing target</em>.</p> <ul><li><p>The source is a string optionally selecting an HTTP method and mandatorily providing a pattern to be matched by a request's URL path. Patterns are supported using <a href="https://www.npmjs.com/package/path-to-regexp" target="_blank" rel="noopener noreferrer">path-to-regexp<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Here are some valid examples:</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;/some/path&quot;
&quot;GET /api/:model/:id&quot;
&quot;POST /api/:model/write/:id&quot;
&quot;ALL /api/:model&quot;
</code></pre></div><p>When omitting provision of HTTP method it defaults to <code>GET</code>.</p></li> <li><p>The target is given</p> <ul><li><p>as a regular function,</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO implement this handler</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>as an arrow function,</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO implement this handler</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>as a string describing function exposed by available <a href="/core/internals/components.html#controllers">controller component</a> or</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;FooController.action&quot;</span><span class="token punctuation">,</span>
<span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Foo.action&quot;</span><span class="token punctuation">,</span> <span class="token comment">// equivalent for &quot;Controller&quot; is optional</span>
<span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Foo::action&quot;</span><span class="token punctuation">,</span> <span class="token comment">// equivalent, just in case you prefer this notation style</span>
</code></pre></div></li> <li><p>as an object selecting function exposed by available <a href="/core/internals/components.html#controllers">controller component</a>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> module<span class="token punctuation">:</span> <span class="token string">&quot;FooController&quot;</span><span class="token punctuation">,</span> method<span class="token punctuation">:</span> <span class="token string">&quot;action&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> module<span class="token punctuation">:</span> <span class="token string">&quot;Foo&quot;</span><span class="token punctuation">,</span> method<span class="token punctuation">:</span> <span class="token string">&quot;action&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> module<span class="token punctuation">:</span> <span class="token string">&quot;Foo&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// default for &quot;method&quot; is &quot;index&quot;</span>
<span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> controller<span class="token punctuation">:</span> <span class="token string">&quot;Foo&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> policy<span class="token punctuation">:</span> <span class="token string">&quot;Foo&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><div class="tip custom-block"><p><strong>controller</strong> and <strong>policy</strong> are just aliases for <strong>module</strong> supported for readability, only. They don't enable use of controllers in declaring policies or use of policies in declaring routes.</p></div> <p>Using this most complex syntax it is possible to declare additional arguments provided on invoking either request handler:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> module<span class="token punctuation">:</span> <span class="token string">&quot;Foo&quot;</span><span class="token punctuation">,</span> method<span class="token punctuation">:</span> <span class="token string">&quot;action&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bar&quot;</span>
<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>Those arguments are appended to the regularly provided arguments <code>req</code>, <code>res</code> and - in case of policies, only - <code>next</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// in api/controllers/foo.js</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">action</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> foo<span class="token punctuation">,</span> bar</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// foo will contain &quot;foo&quot; due to given declaration</span>
    <span class="token comment">// bar will contain &quot;bar&quot; due to given declaration</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">Regular Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>routes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;FooController.action&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;/api/:model&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> module<span class="token punctuation">:</span> <span class="token string">&quot;ModelController&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;/api/:model/:id&quot;</span><span class="token punctuation">(</span> req<span class="token punctuation">,</span> res <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello World!&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Example With Routing Slots</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>routes <span class="token operator">=</span> <span class="token punctuation">{</span>
    early<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;/some/route&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;FooController.action&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/api/:model&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> module<span class="token punctuation">:</span> <span class="token string">&quot;ModelController&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    after<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;/api/:model/:id&quot;</span><span class="token punctuation">(</span> req<span class="token punctuation">,</span> res <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello World!&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="config-bodyparser"><a href="#config-bodyparser" aria-hidden="true" class="header-anchor">#</a> config.bodyParser</h3> <p>This property is exposing a function invoked with a buffer representing a request's raw body. It is invoked to parse this buffer for some contained information provided on invoking <a href="#req-fetchbody-parser"><code>req.fetchBody()</code></a> without any parameter. The function may return promise to deferredly deliver parsed content.</p> <h3 id="config-hitchy-deepcomponents-0-3-3"><a href="#config-hitchy-deepcomponents-0-3-3" aria-hidden="true" class="header-anchor">#</a> config.hitchy.deepComponents <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>0.3.3+</span></h3> <p>This boolean property controls whether Hitchy is deeply searching for components in either type's sub-folder or not. Deep search is enabled by default.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>When set or omitted, a file <strong>api/controllers/user/management.js</strong> is discovered and exposed as <code>api.runtime.controllers.UserManagement</code>. Otherwise this file isn't discovered and therefore won't be exposed at all as it isn't found in <strong>api/controllers</strong> directly.</p></div> <div class="warning custom-block"><p>This property is commonly merged into global configuration object, but exposure of components relies on either plugin's as well as application's individual configuration, only.</p></div> <div class="warning custom-block"><p class="custom-block-title">Compatibility</p> <p>Versions before v0.3.3 did not support deep searching components at all. Due to enabling it since then by default you need to explicitly set this property <code>false</code> to stick with the previous behaviour.</p></div> <div class="warning custom-block"><p class="custom-block-title">Risk of Conflicts</p> <p>When deeply searching components two different files might be exposed under the same name due to the way files in sub-folders are processed.</p> <p>A file <strong>api/controllers/management/user.js</strong> is discovered as <strong>management/user.js</strong>. The component's name is derived by converting slashes into dashes, dropping extension, reverting order of segments and eventually converting naming style from kebab-case to PascalCase, thus resulting in <strong>UserManagement</strong>.</p> <p>A file <strong>api/controllers/user-management.js</strong> will lead to same component name as well, though. There are no slashes to replace and no segments to be reverted, but dashes are used already, extension is dropped and naming style is converted from kebab-case to PascalCase, thus also resulting in <strong>UserManagement</strong>.</p> <p>Deeply searching for components processes either folder before descending into sub-folders, thus in this example the former would be exposed last and thus replacing the latter.</p></div> <h3 id="config-hitchy-appendfolders-0-3-3"><a href="#config-hitchy-appendfolders-0-3-3" aria-hidden="true" class="header-anchor">#</a> config.hitchy.appendFolders <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>0.3.3+</span></h3> <p>When using sub-folders per type of component for organising components this option is controlling whether names of containing sub-folders are prepended to files' names or appended to them in reverse order. The latter case is used by default so you need to explicitly set this configuration property <code>false</code> to achieve the former case.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>Consider an application with a <strong>api/services</strong> looking like this:</p> <div class="language- extra-class"><pre class="language-text"><code>+ api/services
  + management
    + user
        system-admin.js
        guest.js
      room.js  
</code></pre></div><p>By default this results in exposing these service components:</p> <ul><li><strong>SystemAdminUserManagement</strong></li> <li><strong>GuestUserManagement</strong></li> <li><strong>RoomManagement</strong></li></ul> <p>When setting <code>config.hitchy.appendFolder</code> to be false the resulting service components are exposed like this:</p> <ul><li><strong>ManagementUserSystemAdmin</strong></li> <li><strong>ManagementUserGuest</strong></li> <li><strong>ManagementRoom</strong></li></ul></div> <div class="warning custom-block"><p>This property is commonly merged into global configuration object, but exposure of components relies on either plugin's as well as application's individual configuration, only.</p></div> <h2 id="api-elements"><a href="#api-elements" aria-hidden="true" class="header-anchor">#</a> API Elements</h2> <p>Hitchy's API can be divided into several sections to be described here.</p> <div class="tip custom-block"><p>The following description assumes you know <a href="#gaining-access">how to gain access on Hitchy's API</a> in either situation, thus referring to it using just <code>api</code>.</p></div> <h3 id="api-config-0-3-0"><a href="#api-config-0-3-0" aria-hidden="true" class="header-anchor">#</a> api.config <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>+0.3.0</span></h3> <p>All configuration of every available plugin as well as the application itself is <a href="/core/internals/bootstrap.html#configuration">loaded from Javascript files in either ones' <strong>config</strong> sub-folder</a> and merged into a single configuration object which is exposed here.</p> <h4 id="api-config-appconfig"><a href="#api-config-appconfig" aria-hidden="true" class="header-anchor">#</a> api.config.$appConfig</h4> <p>Configuration provided in <code>api.config</code> always includes options exported by available plugins. If you need to access the application's own configuration - which is merged from reading all Javascript files in application's sub-folder <strong>config</strong> - this basically hidden property can be used.</p> <p>This is the application's counterpart to either plugin's <a href="/core/api/plugins.html#plugin-config-0-3-3">exposure of its pure configuration</a>.</p> <h3 id="api-runtime"><a href="#api-runtime" aria-hidden="true" class="header-anchor">#</a> api.runtime</h3> <p>This section of Hitchy's API is exposing a compilation of all components exposed by discovered plugins as well as current application itself. They are grouped by component type.</p> <ul><li>Controllers are exposed in <code>api.runtime.controllers</code>.</li> <li>Policies are exposed in <code>api.runtime.policies</code>.</li> <li>Models are exposed in <code>api.runtime.models</code>.</li> <li>Services are exposed in <code>api.runtime.services</code>.</li></ul> <p>For the sake of flexibility and fault tolerance either group is exposed using its singular name as well. Thus using <code>api.runtime.controller</code> is equivalent to using <code>api.runtime.controllers</code> etc.</p> <div class="warning custom-block"><p class="custom-block-title">Change of API</p> <p>Starting with version 0.3.0 the configuration isn't available as <code>api.runtime.config</code> anymore, but exposed as <a href="#api-config"><code>api.config</code></a>.</p></div> <h3 id="api-data"><a href="#api-data" aria-hidden="true" class="header-anchor">#</a> api.data</h3> <p>Hitchy's API gets sealed after bootstrap has finished to prevent intended or accidental change of any exposed API.</p> <p>This property is excluded in particular to provide a common space multiple components can use for saving and sharing data that's exceeding the lifetime of a single request.</p> <h3 id="api-log"><a href="#api-log" aria-hidden="true" class="header-anchor">#</a> api.log</h3> <p>This function is a generator for logging facilities. It is invoked with the name of a logging facility and returns another function which can be used to actually generate log messages on behalf of either facility.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> AlertLog <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;hitchy:plugin:tooling:alert&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> DebugLog <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;hitchy:plugin:tooling:debug&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">DebugLog</span><span class="token punctuation">(</span> <span class="token string">&quot;got some configuration&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">AlertLog</span><span class="token punctuation">(</span> <span class="token string">&quot;connection lost&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <p>Basically, facilities are supported to cluster your application's log and help with controlling what messages are actually logged or not making it more useful in either situation.</p> <div class="tip custom-block"><p class="custom-block-title">Environment-Based Control</p> <p>Environment variable <strong>DEBUG</strong> is examined for providing a comma-separated list of facilities to be enabled.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">DEBUG</span><span class="token operator">=</span>hitchy:*,myapp:*,-*
</code></pre></div><p>Every item of that list</p> <ul><li>is a facility name to be logged,</li> <li>may be prefixed with single dash <code>-</code> to explicitly exclude a matching facility from logging,</li> <li>may contain asterisk <code>*</code> for matching multiple facilities to be enabled or disabled.</li></ul></div> <div class="warning custom-block"><p class="custom-block-title">Naming Convention</p> <p>Facility names should represent a hierarchy of facilities by extending the name of a superordinated facility with a colon and the intended facility's name.</p> <p>Sticking to this pattern is beneficial on using asterisk <code>*</code> in logging control.</p></div> <h3 id="api-utility-file"><a href="#api-utility-file" aria-hidden="true" class="header-anchor">#</a> api.utility.file</h3> <p>This subsection provides helper functions used by Hitchy for accessing local file system.</p> <div class="warning custom-block"><p class="custom-block-title">Deprecation Warning</p> <p>There is a more powerful package <a href="https://www.npmjs.com/package/file-essentials" target="_blank" rel="noopener noreferrer">file-essentials<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and we consider to replace these functions with that package in a future release.</p></div> <h3 id="api-utility-promise"><a href="#api-utility-promise" aria-hidden="true" class="header-anchor">#</a> api.utility.promise</h3> <p>This subsection provides helper functions to simplify complex asynchronous processes using promises.</p> <div class="warning custom-block"><p class="custom-block-title">Deprecation Warning</p> <p>There is a more powerful package <a href="https://www.npmjs.com/package/promise-essentials" target="_blank" rel="noopener noreferrer">promise-essentials<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and we consider to replace these functions with that package in a future release.</p></div> <h3 id="api-utility-object"><a href="#api-utility-object" aria-hidden="true" class="header-anchor">#</a> api.utility.object</h3> <p>This subsection provides helper functions for</p> <ul><li><p>deeply merging objects:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>target <span class="token operator">=</span> api<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>object<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span> target<span class="token punctuation">,</span> sourceA<span class="token punctuation">,</span> sourceB<span class="token punctuation">,</span> <span class="token operator">...</span> <span class="token punctuation">)</span>
</code></pre></div></li> <li><p>deeply sealing objects:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>object <span class="token operator">=</span> api<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>object<span class="token punctuation">.</span><span class="token function">seal</span><span class="token punctuation">(</span> object <span class="token punctuation">)</span>
</code></pre></div><p>A callback may be provided in second argument to be called on every object to be sealed. It is invoked with breadcrumb of property names as array of strings and assumed to return boolean indicating whether either object should be actually sealed or not.</p></li> <li><p>deeply freezing objects:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>object <span class="token operator">=</span> api<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span> object <span class="token punctuation">)</span>
</code></pre></div><p>A callback may be provided in second argument to be called on every object to be frozen. It is invoked with breadcrumb of property names as array of strings and assumed to return boolean indicating whether either object should be actually frozen or not.</p></li></ul> <h3 id="api-utility-case"><a href="#api-utility-case" aria-hidden="true" class="header-anchor">#</a> api.utility.case</h3> <p>This subsection provides functions for converting between different practices for writing names.</p> <ul><li><p>kebab-case to PascalCase:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>pascal <span class="token operator">=</span> api<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>case<span class="token punctuation">.</span><span class="token function">kebabToPascal</span><span class="token punctuation">(</span> <span class="token string">&quot;kebab-case&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>kebab-case to camelCase:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>camel <span class="token operator">=</span> api<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>case<span class="token punctuation">.</span><span class="token function">kebabToCamel</span><span class="token punctuation">(</span> <span class="token string">&quot;kebab-case&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>PascalCase to kebab-case:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>kebab <span class="token operator">=</span> api<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>case<span class="token punctuation">.</span><span class="token function">pascalToKebab</span><span class="token punctuation">(</span> <span class="token string">&quot;PascalCase&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>camelCase to kebab-case:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>kebab <span class="token operator">=</span> api<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>case<span class="token punctuation">.</span><span class="token function">camelToKebab</span><span class="token punctuation">(</span> <span class="token string">&quot;camelCase&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>camelCase to PascalCase:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>pascal <span class="token operator">=</span> api<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>case<span class="token punctuation">.</span><span class="token function">camelToPascal</span><span class="token punctuation">(</span> <span class="token string">&quot;camelCase&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="api-client"><a href="#api-client" aria-hidden="true" class="header-anchor">#</a> api.Client</h3> <p>This class is providing router client suitable for locally triggering request dispatching.</p> <div class="warning custom-block"><p class="custom-block-title">Obey The Naming!</p> <p>This class is exposed using PascalCase name to comply with common rules of code style linters.</p></div> <p>This client can be used to simulate requests for testing purposes, for improved request processing e.g. via websockets or for locally triggering request handlers e.g. for transparently rewriting requests or similar.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">api<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
    method<span class="token punctuation">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> 
    url<span class="token punctuation">:</span> <span class="token string">&quot;/some/internal/url?foo=bar&quot;</span><span class="token punctuation">,</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;content-type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;text/json&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> some<span class="token punctuation">:</span> <span class="token string">&quot;input&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> client<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> res<span class="token punctuation">.</span>statusCode <span class="token operator">===</span> <span class="token number">200</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">body</span> <span class="token operator">=&gt;</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span> body<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span> <span class="token string">&quot;utf8&quot;</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token comment">// TODO: process response</span>
                <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="tip custom-block"><p>This client simulates <em>most</em> parts of <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_clientrequest" target="_blank" rel="noopener noreferrer">ClientRequest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_serverresponse" target="_blank" rel="noopener noreferrer">ServerResponse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. In addition method <code>res.body()</code> is provided to simplify retrieval of response body.</p></div> <h3 id="api-plugins"><a href="#api-plugins" aria-hidden="true" class="header-anchor">#</a> api.plugins</h3> <p>All discovered and loaded plugins are listed in this property. It is an object mapping a <a href="/core/api/plugins.html#roles">plugin's role</a> (which might be different from its name!) into either plugin's API.</p> <h3 id="api-cmp"><a href="#api-cmp" aria-hidden="true" class="header-anchor">#</a> api.cmp</h3> <p><strong>Signature:</strong> <code>api.cmp( &quot;./my/module&quot;, [ arg1, arg2 ] )</code></p> <p>This method is loading selected module with support for <a href="#using-common-module-pattern">common module pattern</a>. Optionally provided arguments are passed in addition to options on invoking function exposed by selected module as part of common module pattern.</p> <p>If selected module doesn't comply with that pattern it is loaded as usual.</p> <h3 id="api-cmfp"><a href="#api-cmfp" aria-hidden="true" class="header-anchor">#</a> api.cmfp</h3> <p><strong>Signature:</strong> <code>api.cmfp( someFunction, [ arg1, arg2 ] )</code></p> <p>This method is invoking some function provided by reference with support for <em>common module function pattern</em>. This pattern is derived from <a href="#using-common-module-pattern">common module pattern</a> and is meant to invoke particular functions of plugins in a similar way.</p> <p>Invoked functions are assumed to expect Hitchy's API as <code>this</code> and global options provided in first argument which is implicitly prepended by this method.</p> <h2 id="request-context"><a href="#request-context" aria-hidden="true" class="header-anchor">#</a> Request Context</h2> <p>On request handling routes are used to select handlers to be invoked. Those handlers areare functions invoked with <code>this</code> referring to a <em>request context</em> which is providing information related to currently dispatched request.</p> <div class="tip custom-block"><p>In a request handler like</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO add some handling code here</span>
<span class="token punctuation">}</span>
</code></pre></div><p>the <em>request context</em> is available using <code>this</code>.</p></div> <h3 id="this-request"><a href="#this-request" aria-hidden="true" class="header-anchor">#</a> this.request</h3> <p>This property is a reference on <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_incomingmessage" target="_blank" rel="noopener noreferrer">IncomingMessage<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> describing current request to be handled. It is identical to the reference provided in first argument usually named <code>req</code> of either handler.</p> <h3 id="this-response"><a href="#this-response" aria-hidden="true" class="header-anchor">#</a> this.response</h3> <p>This property is a reference on <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_serverresponse" target="_blank" rel="noopener noreferrer">ServerResponse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for managing response to be sent. It is identical to the reference provided in second argument usually named <code>res</code> of either handler.</p> <h3 id="this-local"><a href="#this-local" aria-hidden="true" class="header-anchor">#</a> this.local</h3> <p>This object is provided for sharing volatile information between handlers involved in handling a particular request. This information is shared between policies and controllers participating in handling a request and gets dropped when handling request has finished.</p> <h3 id="this-api"><a href="#this-api" aria-hidden="true" class="header-anchor">#</a> this.api</h3> <p><a href="#api-elements">Hitchy's API</a> is provided in request context for simplified access.</p> <h3 id="this-config-0-3-0"><a href="#this-config-0-3-0" aria-hidden="true" class="header-anchor">#</a> this.config <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>+0.3.0</span></h3> <p>This property is an alias for simplified access on <a href="#api-config"><code>api.config</code></a> of Hitchy's API exposing current runtime configuration.</p> <h3 id="this-runtime"><a href="#this-runtime" aria-hidden="true" class="header-anchor">#</a> this.runtime</h3> <p>This property is an alias for simplified access on <a href="#api-runtime"><code>api.runtime</code></a> of Hitchy's API exposing available components.</p> <h3 id="this-controllers-0-3-0"><a href="#this-controllers-0-3-0" aria-hidden="true" class="header-anchor">#</a> this.controllers <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>+0.3.0</span></h3> <p>This is another alias for simplifying access on collection of available controllers.</p> <div class="tip custom-block"><p>Using <code>this.controller</code> is supported as well.</p></div> <h3 id="this-policies-0-3-0"><a href="#this-policies-0-3-0" aria-hidden="true" class="header-anchor">#</a> this.policies <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>+0.3.0</span></h3> <p>This alias is simplifying access on collection of available policies.</p> <div class="tip custom-block"><p>Using <code>this.policy</code> is supported as well.</p></div> <h3 id="this-services-0-3-0"><a href="#this-services-0-3-0" aria-hidden="true" class="header-anchor">#</a> this.services <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>+0.3.0</span></h3> <p>This alias is simplifying access on collection of available services.</p> <div class="tip custom-block"><p>Using <code>this.service</code> is supported as well.</p></div> <h3 id="this-models-0-3-0"><a href="#this-models-0-3-0" aria-hidden="true" class="header-anchor">#</a> this.models <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>+0.3.0</span></h3> <p>This alias is simplifying access on collection of available models.</p> <div class="tip custom-block"><p>Using <code>this.model</code> is supported as well.</p></div> <h3 id="this-starttime"><a href="#this-starttime" aria-hidden="true" class="header-anchor">#</a> this.startTime</h3> <p>This property is exposing the time of handling current request has started as number of milliseconds since midnight of January 1st, 1970.</p> <h3 id="this-context-0-3-0"><a href="#this-context-0-3-0" aria-hidden="true" class="header-anchor">#</a> this.context <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>+0.3.0</span></h3> <p>This property is a string naming the service hitchy is integrated with. Currently supported values are:</p> <ul><li><code>standalone</code> when running current application without any integration into some other application.</li> <li><code>express</code> when running current application with Hitchy integrated into an Express-based application.</li></ul> <h3 id="this-done"><a href="#this-done" aria-hidden="true" class="header-anchor">#</a> this.done</h3> <p>This callback is provided by the service Hitchy is integrating with. When using Hitchy with <a href="https://expressjs.com/" target="_blank" rel="noopener noreferrer">Express<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> invoking this function is starting next handler function registered with Express skipping any code that's authoritative in scope of Hitchy integrating with Express.</p> <div class="tip custom-block"><p class="custom-block-title">Caution</p> <p>Don't use this function for it might be causing significant side effects.</p></div> <h3 id="this-consumed"><a href="#this-consumed" aria-hidden="true" class="header-anchor">#</a> this.consumed</h3> <p>This property contains markers used internally to handle cases that haven't been handled by any controller. You shouldn't use or adjust those marks.</p> <h2 id="request-helpers"><a href="#request-helpers" aria-hidden="true" class="header-anchor">#</a> Request Helpers</h2> <p>In request handlers of <a href="/core/internals/components.html#controllers">controllers</a> and <a href="/core/internals/components.html#policies">policies</a> there are two provided arguments usually named <code>req</code> and <code>res</code>. The former is basically an <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_incomingmessage" target="_blank" rel="noopener noreferrer">IncomingMessage<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and the latter is a <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_serverresponse" target="_blank" rel="noopener noreferrer">ServerResponse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. But either object is extended to provide additional information and functionality.</p> <div class="warning custom-block"><p class="custom-block-title">Standalone vs. Integrated With ExpressJS</p> <p>Most helpers described here are basically available in a standalone Hitchy application. When using <a href="/core/internals/architecture-basics.html#integrating-with-services">Hitchy integrated with ExpressJS</a> most of these helpers are provided by ExpressJS and thus may behave differently.</p></div> <div class="tip custom-block"><p>In a request handler like</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO add some handling code here</span>
<span class="token punctuation">}</span>
</code></pre></div><p>the <em>request helpers</em> are available as part of object provided as <code>req</code>.</p></div> <h3 id="req-accept"><a href="#req-accept" aria-hidden="true" class="header-anchor">#</a> <code>req.accept</code></h3> <p>A properly sorted list of MIME type ranges is provided in this property according to any current request's <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept" target="_blank" rel="noopener noreferrer">Accept<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> header field. There is always a list of MIME ranges and either item is provided without optional parameters.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>When handling request with header <code>Accept: text/*;q=0.5, text/json</code> this property will expose sorted list of given MIME ranges <code>[ &quot;text/json&quot;, &quot;text/*&quot; ]</code>.</p></div> <h3 id="req-cookies"><a href="#req-cookies" aria-hidden="true" class="header-anchor">#</a> <code>req.cookies</code></h3> <div class="warning custom-block"><p class="custom-block-title">Requires Plugin</p> <p>This property requires installation of plugin <a href="https://www.npmjs.com/package/hitchy-plugin-cookies" target="_blank" rel="noopener noreferrer">hitchy-plugin-cookies<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as a dependency of your project.</p></div> <p>This property exposes object containing all cookies transmitted by client in current request.</p> <h3 id="req-fetchbody-parser"><a href="#req-fetchbody-parser" aria-hidden="true" class="header-anchor">#</a> <code>req.fetchBody( parser )</code></h3> <p>This method promises request's body. The optional parameter can be used to control parser used for extracting contained information.</p> <div class="warning custom-block"><p>When integrating with ExpressJS it might have fetched and parsed request body before exposing it as <code>req.body</code>. In this case Hitchy isn't capable of accessing raw request body anymore. This is limiting use of this function.</p> <p>Supporting this scenario any existing data in <code>req.body</code> will be delivered whenever using this function for <em>fetching</em> request's body without regards to some optionally selected parser.</p></div> <ul><li><p>When omitted or set <code>null</code> any parser function in configuration is used to commonly parse raw body for contained information. When there is no configured parser some fallback is used supporting JSON and form-encoded request bodies.</p></li> <li><p>On providing function here this one is used to parse the raw body instead of any configured or fallback parser.</p></li> <li><p>On providing <code>false</code> the raw body is promised as instance of Buffer. This is bypassing any parser to be invoked thus won't result in caching some parser's output as well.</p></li></ul> <div class="warning custom-block"><p>This method is caching any previously extracted body data in association with provided parser argument. Thus, re-invoking this method with a different parser results in parsing raw body again while providing same parser re-fetches same information as before.</p> <p>When providing custom function make sure to provide the same instance of that function to benefit from this caching. As an option assign a global body parser function in configuration as <code>config.bodyParser</code>.</p></div> <h3 id="req-hitchy-0-2-0"><a href="#req-hitchy-0-2-0" aria-hidden="true" class="header-anchor">#</a> <code>req.hitchy</code> <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>0.2.0+</span></h3> <p>This property is exposing <a href="#hitchys-api">Hitchy's API</a>.</p> <h3 id="req-params"><a href="#req-params" aria-hidden="true" class="header-anchor">#</a> <code>req.params</code></h3> <p>This object is populated with named segments of currently dispatched route.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>If your handler is bound to handle a route like <code>GET /api/:model/:item</code> and client was requesting <code>/api/user/123</code> then <code>req.params</code> looks like this:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    model<span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
    item<span class="token operator">:</span> <span class="token string">&quot;123&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="req-path"><a href="#req-path" aria-hidden="true" class="header-anchor">#</a> <code>req.path</code></h3> <p>This property conveniently provides current request's path which is the requested URL without any appended query string or hash.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>On requesting <code>/some/path/name?with=arg</code> this property will provide <code>/some/path/name</code>.</p></div> <h3 id="req-query"><a href="#req-query" aria-hidden="true" class="header-anchor">#</a> <code>req.query</code></h3> <p>This property is an object exposing all query parameters.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>On requesting <code>/some/path/name?with=arg&amp;another=one</code> this property will provide the following object:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    with<span class="token operator">:</span> <span class="token string">&quot;arg&quot;</span><span class="token punctuation">,</span>
    another<span class="token operator">:</span>  <span class="token string">&quot;one&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="req-session"><a href="#req-session" aria-hidden="true" class="header-anchor">#</a> <code>req.session</code></h3> <div class="warning custom-block"><p class="custom-block-title">Requires Plugin</p> <p>This property requires installation of plugin <a href="https://www.npmjs.com/package/hitchy-plugin-session" target="_blank" rel="noopener noreferrer">hitchy-plugin-session<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as a dependency of your project.</p></div> <p>This object consists of two properties meant to provide server-side session shared by different requests transmitted from same client.</p> <ul><li><p>In <code>req.session.user</code> currently authenticated user is stored.</p> <div class="warning custom-block"><p>This feature needs installation of another plugin, e.g. <a href="https://www.npmjs.com/package/hitchy-plugin-auth" target="_blank" rel="noopener noreferrer">hitchy-plugin-auth<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div></li> <li><p><code>req.session.data</code> can be used in your controllers and policies to store arbitrary information regarding currently requesting client.</p> <p>Make sure any stored information can be serialized, thus you shouldn't put instances of some custom class in here, but use native data suitable for converting to/from JSON, only.</p></li></ul> <div class="tip custom-block"><p class="custom-block-title">Supported Scenarios</p> <p>Sessions rely on client passing session cookie in every request following some initial one. Usually this is available with browsers requesting pages and assets on behalf of a user. You should not rely on this session feature when it comes to REST APIs, though.</p></div> <h2 id="response-helpers"><a href="#response-helpers" aria-hidden="true" class="header-anchor">#</a> Response Helpers</h2> <p>In handling requests there is a response manager provided in second argument usually named <code>res</code>. Basically this is an instance of <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_serverresponse" target="_blank" rel="noopener noreferrer">ServerResponse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. But Hitchy is injecting some additional methods for simplifying generation of responses.</p> <div class="tip custom-block"><p class="custom-block-title">Fluent Interface</p> <p>Those <em>additional methods</em> listed below are providing fluent interface for chaining multiple invocations.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span> <span class="token number">400</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token string">&quot;content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/json&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>However, signatures of methods natively provided as part of <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_class_http_serverresponse" target="_blank" rel="noopener noreferrer">ServerResponse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> aren't adjusted.</p></div> <div class="tip custom-block"><p class="custom-block-title">Preventing Response on HEAD Requests <span class="badge info" style="vertical-align:top;" data-v-c13ee5b0>0.2.2+</span></p> <p>Requests using HTTP method HEAD must not provide a response. Disobeying this usually results in exceptions thrown e.g. on trying to send some JSON-formatted response.</p> <p>Hitchy is designed to detect any such request limiting capabilities of response manager's methods related to describing some actual content. That's why you don't need to take care of omitting response content in handlers supported HEAD requests as well.</p></div> <div class="warning custom-block"><p class="custom-block-title">Standalone vs. Integrated With ExpressJS</p> <p>Most helpers described here are basically available in a standalone Hitchy application. When using <a href="/core/internals/architecture-basics.html#integrating-with-services">Hitchy integrated with ExpressJS</a> most of these helpers are provided by ExpressJS and thus may behave differently.</p></div> <div class="tip custom-block"><p>In a request handler like</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO add some handling code here</span>
<span class="token punctuation">}</span>
</code></pre></div><p>the <em>response helpers</em> are available as part of object provided as <code>res</code>.</p></div> <h3 id="res-format-handlers"><a href="#res-format-handlers" aria-hidden="true" class="header-anchor">#</a> <code>res.format( handlers )</code></h3> <p>This method provides different handlers for generating response with each handler bound to one particular type or format of response data. According to current request's <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept" target="_blank" rel="noopener noreferrer">Accept<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> header the best matching handler is picked to eventually create a response.</p> <p>A special handler named <code>default</code> is used if neither provided handler is matching any type of response accepted in current request. If this default handler is missing a <code>406 Not Acceptable</code> is issued implicitly in that case.</p> <p>Handlers' names are either MIME types or some supported filename extensions considered aliases for related MIME type.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>Using this function in a request handler</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
    <span class="token function">html</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token string">&quot;&lt;html&gt;...&lt;/html&gt;&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;text/json&quot;</span><span class="token punctuation">(</span> req<span class="token punctuation">,</span> res <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> some<span class="token punctuation">:</span> <span class="token string">&quot;data&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">(</span> req<span class="token punctuation">,</span> res <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token string">&quot;unsupported type of response&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><p>the response is provided as JSON when requesting with <code>Accept: text/json</code> and as an HTML document when requesting with <code>Accept: text/html</code>.</p></div> <h3 id="res-json-data"><a href="#res-json-data" aria-hidden="true" class="header-anchor">#</a> <code>res.json( data )</code></h3> <p>This method generates a JSON-formatted response and sends it to the client. It is ending current response implicitly.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> some<span class="token punctuation">:</span> <span class="token string">&quot;data&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-redirect-statuscode-url"><a href="#res-redirect-statuscode-url" aria-hidden="true" class="header-anchor">#</a> <code>res.redirect( statusCode, url )</code></h3> <p>Use this helper to instantly generate and send response requesting user to fetch different URL for some desired information.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span> <span class="token number">301</span><span class="token punctuation">,</span> <span class="token string">&quot;https://example.com/&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-send-content"><a href="#res-send-content" aria-hidden="true" class="header-anchor">#</a> <code>res.send( content )</code></h3> <p>This method is sending provided content to the client implicitly ending response to current request. The response's type of content depends on type of value provided as <code>content</code> here:</p> <ul><li><p>Providing an object the response is JSON-formatted.</p></li> <li><p>When providing a string the response is sent as plain text unless having set some different <code>content-type</code> header before.</p></li> <li><p>When providing an instance of Buffer or any other kind of data the response is an octet stream with MIME type <code>application/octet-stream</code>.</p></li></ul> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> some<span class="token punctuation">:</span> <span class="token string">&quot;data&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span> <span class="token string">&quot;...&quot;</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-set-name-value"><a href="#res-set-name-value" aria-hidden="true" class="header-anchor">#</a> <code>res.set( name, value )</code></h3> <p>Adjusts single field of response header. Internally this function is invoking <code>res.setHeader()</code>.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token string">&quot;content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/json;charset=utf8&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token string">&quot;x-api-level&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-set-fields"><a href="#res-set-fields" aria-hidden="true" class="header-anchor">#</a> <code>res.set( fields )</code></h3> <p>Adjusts multiple fields of response header at once. Internally this function is invoking <code>res.setHeader()</code> for every listed header field.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;content-type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;text/json;charset=utf8&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;x-api-level&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;3&quot;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="res-status-code"><a href="#res-status-code" aria-hidden="true" class="header-anchor">#</a> <code>res.status( code )</code></h3> <p>Adjusts HTTP response status code.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span> <span class="token number">404</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">&quot;no such data&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div></div> <h3 id="res-type-mime"><a href="#res-type-mime" aria-hidden="true" class="header-anchor">#</a> <code>res.type( mime )</code></h3> <p>Adjusts <code>content-type</code> header field of response supporting several aliases for simplified selection of response type.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span> <span class="token string">&quot;json&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> <span class="token boolean">true</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span> <span class="token string">&quot;image/png&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> bufferContainingPNG <span class="token punctuation">)</span>
</code></pre></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/core/assets/js/app.f44c65b6.js" defer></script><script src="/core/assets/js/2.e41aa8d4.js" defer></script><script src="/core/assets/js/7.75efe953.js" defer></script><script src="/core/assets/js/4.22891a47.js" defer></script>
  </body>
</html>
