<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Components | Hitchy Manual</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/core/assets/css/0.styles.9c038e3a.css" as="style"><link rel="preload" href="/core/assets/js/app.9347ea5f.js" as="script"><link rel="preload" href="/core/assets/js/2.e41aa8d4.js" as="script"><link rel="preload" href="/core/assets/js/12.40590dd5.js" as="script"><link rel="prefetch" href="/core/assets/js/10.b5f61715.js"><link rel="prefetch" href="/core/assets/js/11.49639186.js"><link rel="prefetch" href="/core/assets/js/13.2e739246.js"><link rel="prefetch" href="/core/assets/js/14.84194869.js"><link rel="prefetch" href="/core/assets/js/15.1eb4d3ff.js"><link rel="prefetch" href="/core/assets/js/16.e4671539.js"><link rel="prefetch" href="/core/assets/js/17.1d67c714.js"><link rel="prefetch" href="/core/assets/js/18.b4dd4c68.js"><link rel="prefetch" href="/core/assets/js/3.8ae28129.js"><link rel="prefetch" href="/core/assets/js/4.22891a47.js"><link rel="prefetch" href="/core/assets/js/5.09b6a9a4.js"><link rel="prefetch" href="/core/assets/js/6.2679362c.js"><link rel="prefetch" href="/core/assets/js/7.2a40e179.js"><link rel="prefetch" href="/core/assets/js/8.f67b320d.js"><link rel="prefetch" href="/core/assets/js/9.d0585eea.js">
    <link rel="stylesheet" href="/core/assets/css/0.styles.9c038e3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/core/" class="home-link router-link-active"><!----> <span class="site-name">Hitchy Manual</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/core/" class="nav-link">Home</a></div><div class="nav-item"><a href="/core/tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/api/index.html" class="nav-link">Hitchy's API</a></li><li class="dropdown-item"><!----> <a href="/core/api/plugins.html" class="nav-link">Plugin API</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Internals</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/internals/architecture-basics.html" class="nav-link">Architecture</a></li><li class="dropdown-item"><!----> <a href="/core/internals/components.html" class="nav-link router-link-exact-active router-link-active">Components</a></li><li class="dropdown-item"><!----> <a href="/core/internals/bootstrap.html" class="nav-link">Plugins</a></li><li class="dropdown-item"><!----> <a href="/core/internals/routing-basics.html" class="nav-link">Routing</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/plugin-odem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Odem
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/hitchyjs/core" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/core/" class="nav-link">Home</a></div><div class="nav-item"><a href="/core/tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">API</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/api/index.html" class="nav-link">Hitchy's API</a></li><li class="dropdown-item"><!----> <a href="/core/api/plugins.html" class="nav-link">Plugin API</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Internals</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/internals/architecture-basics.html" class="nav-link">Architecture</a></li><li class="dropdown-item"><!----> <a href="/core/internals/components.html" class="nav-link router-link-exact-active router-link-active">Components</a></li><li class="dropdown-item"><!----> <a href="/core/internals/bootstrap.html" class="nav-link">Plugins</a></li><li class="dropdown-item"><!----> <a href="/core/internals/routing-basics.html" class="nav-link">Routing</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/core/" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/plugin-odem/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Odem
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/hitchyjs/core" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Components</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/core/internals/components.html#kinds-of-components" class="sidebar-link">Kinds of Components</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/core/internals/components.html#controllers" class="sidebar-link">Controllers</a></li><li class="sidebar-sub-header"><a href="/core/internals/components.html#policies" class="sidebar-link">Policies</a></li><li class="sidebar-sub-header"><a href="/core/internals/components.html#models" class="sidebar-link">Models</a></li><li class="sidebar-sub-header"><a href="/core/internals/components.html#services" class="sidebar-link">Services</a></li></ul></li><li><a href="/core/internals/components.html#exposure-at-runtime" class="sidebar-link">Exposure At Runtime</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="components"><a href="#components" aria-hidden="true" class="header-anchor">#</a> Components</h1> <p>A Hitchy-based application relies on components to be exposed by the application as well as any available plugin. When there are multiple files in installed plugins and your application for the same component all those files are merged in order of plugin discovery.</p> <p>Either component's file is used to derive the component's name. The former are assumed to be in kebab-case, camelCase or PascalCase. The extension <strong>.js</strong> is always dropped. The component's name is in PascalCase.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>A file in folder <strong>api/services/file-zipper.js</strong> is assumed to provide the service component named <strong>FileZipper</strong>.</p></div> <p>Hitchy knows four different kinds of components described below. Either kind of component is assumed to be implemented as a <a href="https://nodejs.org/dist/latest/docs/api/modules.html#modules_modules" target="_blank" rel="noopener noreferrer">CommonJS module as supported by Node.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> currently.</p> <h2 id="kinds-of-components"><a href="#kinds-of-components" aria-hidden="true" class="header-anchor">#</a> Kinds of Components</h2> <h3 id="controllers"><a href="#controllers" aria-hidden="true" class="header-anchor">#</a> Controllers</h3> <p>A controller is a module or class that is exposing methods for eventually handling requests and sending some response. Controllers are discovered in folder <strong>api/controllers</strong> of your application as well as any installed plugin.</p> <p><strong>config/routes.js</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>routes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/my/route&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;GreetingsController.sayHey&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>api/controllers/greetings.js</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">sayHey</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token string">&quot;Hey!&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">About Discovery</p> <p>Talking about the discovery of controllers doesn't imply to have some routes defined for linking either controller's handlers with requests they are meant to handle. Any routing configuration as provided in first example above must be defined manually.</p></div> <h3 id="policies"><a href="#policies" aria-hidden="true" class="header-anchor">#</a> Policies</h3> <p>A policy is a module or class just like a <a href="#controllers">controller</a>. However, it is meant to handle requests collaboratively with other policies and some final controller. Thus it might ignore requests or adjust request information without ever responding to any request. Multiple policies may be involved in processing a single request. That's why policies are capable of passing control to next available policy in chain of processing policies which isn't possible for a controller.</p> <p>Policies are always able to send a response nonetheless. That's useful for implementing filters next to controllers.</p> <p>A final difference between controllers and policies regards the way they are picked to be involved in processing a particular request. Policies are applied to requests sharing prefix of URL path. A controller is obeyed when fully matching a request's URL path.</p> <div class="tip custom-block"><p class="custom-block-title">Example</p> <p>Consider a client is requesting URL <code>/api/user/search?name=John</code>.</p> <p>This request would pick controller routes matching <code>/api/user/search</code> as a whole, only.</p> <p>In opposition to that, any policy route matching <code>/</code>, <code>/api</code>, <code>/api/user</code> or <code>/api/user/search</code> would be picked up for processing in order from shortest to longest matching prefix.</p></div> <p>Policy components are discovered in folder <strong>api/policies</strong> of your application as well as any installed plugin.</p> <p><strong>config/routes.js</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>policies <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;BodyPolicy.accessGranted&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>api/policies/body.js</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">accessGranted</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>token <span class="token operator">===</span> <span class="token string">&quot;secret&quot;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            req<span class="token punctuation">.</span>accessGranted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token string">&quot;x-granted&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span> <span class="token number">403</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">&quot;access forbidden&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">Remarks</p> <p>The preceding example illustrates support for callback provided in third argument for calling next policy in chain of policies to be applied. <strong>In fact, any policy hast to invoke this callback unless it is returning a promise instead.</strong></p> <p>The example also illustrates a policy adjusting response without responding by <a href="/core/api/#res-set-name-value">setting response header</a>.</p> <p>Eventually it shows a <em>filter</em> instantly responding to client in case of an error. In the latter case make sure the response is finished.</p></div> <h3 id="models"><a href="#models" aria-hidden="true" class="header-anchor">#</a> Models</h3> <p>Models are modules or classes describing data to be managed by your application. They are meant to be an interface for accessing data in an attached data storage like a database.</p> <div class="warning custom-block"><p>Hitchy doesn't know much about handling data itself. However, there is a pretty powerful <a href="https://www.npmjs.com/package/hitchy-plugin-odem" target="_blank" rel="noopener noreferrer">plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> you definitely want to check out.</p></div> <p>They are discovered in folder <strong>api/models</strong> of your application as well as any installed plugin.</p> <h3 id="services"><a href="#services" aria-hidden="true" class="header-anchor">#</a> Services</h3> <p>Services are modules or classes as well. They are meant to implement and provide features that are commonly required in controllers, policies and models. Whenever there is code to be used redundantly you should put it in a service.</p> <p>Service components are discovered in folder <strong>api/services</strong> of your application as well as any installed plugin.</p> <h2 id="exposure-at-runtime"><a href="#exposure-at-runtime" aria-hidden="true" class="header-anchor">#</a> Exposure At Runtime</h2> <p>All components are exposed at runtime in section <code>runtime</code> of <a href="../api">Hitchy's API</a>. There are separate groups for every kind of component:</p> <ul><li><code>this.api.runtime.controllers</code></li> <li><code>this.api.runtime.policies</code></li> <li><code>this.api.runtime.models</code></li> <li><code>this.api.runtime.services</code></li></ul> <div class="warning custom-block"><p>In either collection components are exposed using PascalCase name derived from its kebab-case filename.</p></div> <p>For example, the following request handler is accessing a service component named <code>FileZipper</code> which is discovered in file <strong>api/service/file-zipper.js</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">someRequestHandler</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res
        <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span> <span class="token number">200</span> <span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>services<span class="token punctuation">.</span>FileZipper<span class="token punctuation">.</span><span class="token function">listFromArchive</span><span class="token punctuation">(</span> <span class="token string">&quot;some/archive&quot;</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In methods of controllers and policies Hitchy's API is exposed as property <code>hitchy</code> of provided request descriptor as well:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">someRequestHandler</span><span class="token punctuation">(</span> <span class="token parameter">req<span class="token punctuation">,</span> res</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res
        <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span> <span class="token number">200</span> <span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> req<span class="token punctuation">.</span>hitchy<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>services<span class="token punctuation">.</span>FileZipper<span class="token punctuation">.</span><span class="token function">listFromArchive</span><span class="token punctuation">(</span> <span class="token string">&quot;some/archive&quot;</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In either example <code>req.hitchy</code> and <code>this.api</code> are referring to the same API instance. Using <code>req.hitchy</code> is beneficial when using arrow functions as well as on passing request descriptor <code>req</code> into sub-functions.</p> <div class="warning custom-block"><p>Support for <code>req.hitchy</code> has been introduced in v0.2.0.</p></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/core/assets/js/app.9347ea5f.js" defer></script><script src="/core/assets/js/2.e41aa8d4.js" defer></script><script src="/core/assets/js/12.40590dd5.js" defer></script>
  </body>
</html>
